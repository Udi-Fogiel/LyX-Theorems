From 4a6333ca5fbc37e25da383cf4fb2b25ba0c7759e Mon Sep 17 00:00:00 2001
From: Udi Fogiel <udifoglle@gmail.com>
Date: Wed, 21 Sep 2022 07:19:54 +0000
Subject: [PATCH]  On branch master  Your branch is up to date with
 'origin/master'.  Changes to be committed: 	new file:  
 autotests/export/docbook/theorems-thmtools.lyx - a test file for docbook
 export 	new file:   autotests/export/docbook/theorems-thmtools.xml -
 output of the docbook test file 	deleted:   
 lib/layouts/theorems-ams-bytype.inc 	modified:  
 lib/layouts/theorems-ams-bytype.module 	deleted:   
 lib/layouts/theorems-ams-chap-bytype.inc 	modified:  
 lib/layouts/theorems-ams-chap-bytype.module 	modified:  
 lib/layouts/theorems-ams-extended-bytype.module 	modified:  
 lib/layouts/theorems-ams-extended-chap-bytype.module 	modified:  
 lib/layouts/theorems-ams-extended.module 	deleted:   
 lib/layouts/theorems-ams.inc 	modified:   lib/layouts/theorems-ams.module 
 deleted:    lib/layouts/theorems-bytype.inc 	modified:  
 lib/layouts/theorems-bytype.module 	modified:  
 lib/layouts/theorems-chap-bytype.module 	modified:  
 lib/layouts/theorems-chap.module 	new file:  
 lib/layouts/theorems-extended.inc 	new file:  
 lib/layouts/theorems-labels.inc 	modified:  
 lib/layouts/theorems-named.module 	deleted:   
 lib/layouts/theorems-order.inc 	modified:  
 lib/layouts/theorems-proof-std.inc 	modified:  
 lib/layouts/theorems-proof.inc 	modified:  
 lib/layouts/theorems-sec-bytype.module 	modified:  
 lib/layouts/theorems-sec.module 	deleted:   
 lib/layouts/theorems-starred-equivalents.inc 	deleted:   
 lib/layouts/theorems-starred.inc 	deleted:   
 lib/layouts/theorems-starred.module 	modified:  
 lib/layouts/theorems-std.module 	new file:  
 lib/layouts/theorems-thmtools.module 	modified:   lib/layouts/theorems.inc

	I've modified all the non-AMS theorem modules so they would be independent of packages. currently
	the code support \theoremstyle, but only with definition, plain and remark.

	I'v added a new theorem module that support the thmtools \listoftheorems.

	I've modified the syntax of all theorem modules, such that it would be easier to
	create a new one, or maintaining the ones that exists. Instead of using \newtheorem
	in the preamble of a lyaout, I wrote \lyx@newtheorem, and in each module I've defiened
	\lyx@newtheorem as fitted. This way, there is only need in the files thorems-base, and theorems-extended,
	instead of an .inc file for each module.

	I've added theorems-labels.inc, a file that suppose to be included in a "Numbered by type" module,
	to change the Label and the LabelCounter of the layouts in theorems-base.inc.

	Note that in this configuration, all non-AMS modules will clash with the AMS ones, and so as the
	proof versions. theorems-proof-std.inc suppose to be in the non-AMS while theorems-proof.inc
	should be included only in AMS variants.
---
 .../export/docbook/theorems-thmtools.lyx      |  624 ++
 .../export/docbook/theorems-thmtools.xml      |   64 +
 lib/layouts/theorems-ams-bytype.inc           |  341 -
 lib/layouts/theorems-ams-bytype.module        |   25 +-
 lib/layouts/theorems-ams-chap-bytype.inc      |  436 -
 lib/layouts/theorems-ams-chap-bytype.module   |   28 +-
 .../theorems-ams-extended-bytype.module       |  452 +-
 .../theorems-ams-extended-chap-bytype.module  |  498 +-
 lib/layouts/theorems-ams-extended.module      |  445 +-
 lib/layouts/theorems-ams.inc                  |  329 -
 lib/layouts/theorems-ams.module               |   17 +-
 lib/layouts/theorems-bytype.inc               |  336 -
 lib/layouts/theorems-bytype.module            |   67 +-
 lib/layouts/theorems-chap-bytype.module       |  193 +-
 lib/layouts/theorems-chap.module              |   50 +-
 lib/layouts/theorems-extended.inc             |  422 +
 lib/layouts/theorems-labels.inc               |  136 +
 lib/layouts/theorems-named.module             |   71 +-
 lib/layouts/theorems-order.inc                |   83 -
 lib/layouts/theorems-proof-std.inc            |   68 +-
 lib/layouts/theorems-proof.inc                |    1 +
 lib/layouts/theorems-sec-bytype.module        |  145 +-
 lib/layouts/theorems-sec.module               |   49 +-
 lib/layouts/theorems-starred-equivalents.inc  |   88 -
 lib/layouts/theorems-starred.inc              |  319 -
 lib/layouts/theorems-starred.module           |   16 -
 lib/layouts/theorems-std.module               |   47 +-
 lib/layouts/theorems-thmtools.module          |  783 ++
 lib/layouts/theorems.inc                      |  399 +-
 po/ar.gmo                                     |  Bin 436881 -> 432961 bytes
 po/ar.po                                      | 8044 ++++++++--------
 po/bg.gmo                                     |  Bin 333401 -> 528805 bytes
 po/bg.po                                      | 5937 ++++++------
 po/cs.gmo                                     |  Bin 497837 -> 493383 bytes
 po/cs.po                                      | 8107 ++++++++--------
 po/de.gmo                                     |  Bin 629364 -> 628852 bytes
 po/de.po                                      |  834 +-
 po/el.gmo                                     |  Bin 380254 -> 375183 bytes
 po/el.po                                      | 8055 ++++++++--------
 po/en.po                                      | 7691 ++++++++--------
 po/es.gmo                                     |  Bin 443569 -> 439490 bytes
 po/es.po                                      | 8091 ++++++++--------
 po/eu.gmo                                     |  Bin 498542 -> 494312 bytes
 po/eu.po                                      | 8081 ++++++++--------
 po/fi.gmo                                     |  Bin 295544 -> 292412 bytes
 po/fi.po                                      | 8053 ++++++++--------
 po/fr.gmo                                     |  Bin 632379 -> 631535 bytes
 po/fr.po                                      |  854 +-
 po/he.gmo                                     |  Bin 238914 -> 236191 bytes
 po/he.po                                      | 8048 ++++++++--------
 po/hu.gmo                                     |  Bin 300888 -> 296934 bytes
 po/hu.po                                      | 8079 ++++++++--------
 po/ia.gmo                                     |  Bin 574277 -> 569397 bytes
 po/ia.po                                      | 8087 ++++++++--------
 po/id.gmo                                     |  Bin 582787 -> 577842 bytes
 po/id.po                                      | 8096 ++++++++--------
 po/it.po                                      | 1309 +--
 po/ja.gmo                                     |  Bin 520662 -> 516249 bytes
 po/ja.po                                      | 8079 ++++++++--------
 po/nb.gmo                                     |  Bin 408114 -> 404195 bytes
 po/nb.po                                      | 8089 ++++++++--------
 po/nl.gmo                                     |  Bin 557043 -> 552643 bytes
 po/nl.po                                      | 8089 ++++++++--------
 po/nn.gmo                                     |  Bin 324238 -> 320498 bytes
 po/nn.po                                      | 8095 ++++++++--------
 po/pl.gmo                                     |  Bin 322263 -> 318223 bytes
 po/pl.po                                      | 8087 ++++++++--------
 po/pt_BR.gmo                                  |  Bin 502603 -> 606757 bytes
 po/pt_BR.po                                   | 8105 ++++++++--------
 po/pt_PT.gmo                                  |  Bin 397576 -> 393482 bytes
 po/pt_PT.po                                   | 8096 ++++++++--------
 po/ru.gmo                                     |  Bin 753296 -> 746700 bytes
 po/ru.po                                      | 8090 ++++++++--------
 po/sk.gmo                                     |  Bin 602257 -> 613598 bytes
 po/sk.po                                      | 7256 +++++++--------
 po/sv.gmo                                     |  Bin 484553 -> 480359 bytes
 po/sv.po                                      | 8086 ++++++++--------
 po/tr.gmo                                     |  Bin 206743 -> 203438 bytes
 po/tr.po                                      | 8067 ++++++++--------
 po/uk.gmo                                     |  Bin 631065 -> 625604 bytes
 po/uk.po                                      | 8109 +++++++++--------
 po/zh_CN.gmo                                  |  Bin 462377 -> 458524 bytes
 po/zh_CN.po                                   | 8076 ++++++++--------
 po/zh_TW.gmo                                  |  Bin 378445 -> 374682 bytes
 po/zh_TW.po                                   | 8080 ++++++++--------
 85 files changed, 114987 insertions(+), 101315 deletions(-)
 create mode 100644 autotests/export/docbook/theorems-thmtools.lyx
 create mode 100644 autotests/export/docbook/theorems-thmtools.xml
 delete mode 100644 lib/layouts/theorems-ams-bytype.inc
 delete mode 100644 lib/layouts/theorems-ams-chap-bytype.inc
 delete mode 100644 lib/layouts/theorems-ams.inc
 delete mode 100644 lib/layouts/theorems-bytype.inc
 create mode 100644 lib/layouts/theorems-extended.inc
 create mode 100644 lib/layouts/theorems-labels.inc
 delete mode 100644 lib/layouts/theorems-order.inc
 delete mode 100644 lib/layouts/theorems-starred-equivalents.inc
 delete mode 100644 lib/layouts/theorems-starred.inc
 delete mode 100644 lib/layouts/theorems-starred.module
 create mode 100644 lib/layouts/theorems-thmtools.module

diff --git a/autotests/export/docbook/theorems-thmtools.lyx b/autotests/export/docbook/theorems-thmtools.lyx
new file mode 100644
index 0000000000..083ecd2a89
--- /dev/null
+++ b/autotests/export/docbook/theorems-thmtools.lyx
@@ -0,0 +1,624 @@
+#LyX 2.4 created this file. For more info see https://www.lyx.org/
+\lyxformat 609
+\begin_document
+\begin_header
+\save_transient_properties true
+\origin unavailable
+\textclass article
+\begin_preamble
+% Added by lyx2lyx
+\setlength{\parskip}{\smallskipamount}
+\setlength{\parindent}{0pt}
+\end_preamble
+\use_default_options true
+\begin_modules
+theorems-thmtools
+\end_modules
+\maintain_unincluded_children no
+\language english
+\language_package default
+\inputencoding auto-legacy
+\fontencoding auto
+\font_roman "default" "default"
+\font_sans "default" "default"
+\font_typewriter "default" "default"
+\font_math "auto" "auto"
+\font_default_family default
+\use_non_tex_fonts false
+\font_sc false
+\font_roman_osf false
+\font_sans_osf false
+\font_typewriter_osf false
+\font_sf_scale 100 100
+\font_tt_scale 100 100
+\use_microtype false
+\use_dash_ligatures true
+\graphics default
+\default_output_format default
+\output_sync 1
+\bibtex_command default
+\index_command default
+\float_placement class
+\float_alignment class
+\paperfontsize default
+\spacing single
+\use_hyperref true
+\pdf_title "Thmtools Module"
+\pdf_author "Udi Fogiel"
+\pdf_subject "test file for the thmtools module "
+\pdf_keywords "thmtools, module, test"
+\pdf_bookmarks true
+\pdf_bookmarksnumbered false
+\pdf_bookmarksopen false
+\pdf_bookmarksopenlevel 1
+\pdf_breaklinks false
+\pdf_pdfborder true
+\pdf_colorlinks true
+\pdf_backref false
+\pdf_pdfusetitle true
+\pdf_quoted_options "linkcolor=blue"
+\papersize default
+\use_geometry false
+\use_package amsmath 1
+\use_package amssymb 1
+\use_package cancel 1
+\use_package esint 1
+\use_package mathdots 1
+\use_package mathtools 1
+\use_package mhchem 1
+\use_package stackrel 1
+\use_package stmaryrd 1
+\use_package undertilde 1
+\cite_engine basic
+\cite_engine_type default
+\biblio_style plain
+\use_bibtopic false
+\use_indices false
+\paperorientation portrait
+\suppress_date true
+\justification true
+\use_refstyle 1
+\use_minted 0
+\use_lineno 0
+\branch blind
+\selected 1
+\filename_suffix 0
+\color background background
+\end_branch
+\index Index
+\shortcut idx
+\color #008000
+\end_index
+\secnumdepth 3
+\tocdepth 3
+\paragraph_separation indent
+\paragraph_indentation default
+\is_math_indent 0
+\math_numbering_side default
+\quotes_style english
+\dynamic_quotes 0
+\papercolumns 1
+\papersides 1
+\paperpagestyle default
+\tablestyle default
+\bullet 0 0 2 -1
+\tracking_changes false
+\output_changes false
+\change_bars false
+\postpone_fragile_content false
+\html_math_output 0
+\html_css_as_file 0
+\html_be_strict false
+\docbook_table_output 0
+\docbook_mathml_prefix 1
+\end_header
+
+\begin_body
+
+\begin_layout Claim
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Claim*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Conjecture
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Conjecture*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Corollary
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Corollary*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Definition
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Definition*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Example
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Example*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Exercise
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Exercise*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Fact
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Fact*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Lemma
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Lemma*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Problem
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Problem*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Proposition
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Proposition*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Remark
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Theorem
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Theorem*
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+Dummy Note
+\end_layout
+
+\end_inset
+
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Case
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Proof
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+\end_layout
+
+\begin_layout Standard
+\begin_inset Separator plain
+\end_inset
+
+
+\end_layout
+
+\begin_layout Standard
+\begin_inset Flex List of Theorems
+status open
+
+\begin_layout Plain Layout
+
+\begin_inset Argument 1
+status open
+
+\begin_layout Plain Layout
+
+\end_layout
+
+\end_inset
+
+
+\end_layout
+
+\end_inset
+
+
+\end_layout
+
+\end_body
+\end_document
diff --git a/autotests/export/docbook/theorems-thmtools.xml b/autotests/export/docbook/theorems-thmtools.xml
new file mode 100644
index 0000000000..ef0e8fc1be
--- /dev/null
+++ b/autotests/export/docbook/theorems-thmtools.xml
@@ -0,0 +1,64 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- This DocBook file was created by LyX 2.4.0dev
+  See https://www.lyx.org/ for more information -->
+<article xml:lang="en_US" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.2">
+<title>Untitled Document</title>
+<note role='claim'>
+Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+</note>
+<note role='claim'>
+Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.
+</note>
+<para role='conjecture'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='conjecture'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='corollary'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='corollary'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='definition'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='definition'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<informalexample>
+<para>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+</informalexample>
+<informalexample>
+<para>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+</informalexample>
+<para role='exercise'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='exercise'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='fact'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='fact'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='lemma'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='lemma'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='problem'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='problem'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='proposition'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='proposition'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<note role='theorem'>
+<para>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+</note>
+<para role='theorem'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='theorem'>Dummy Note
+Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='cases'>Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+<para role='proof'>Dummy Text, Dummy Text, Dummy Text, Dummy Text.</para>
+</article>
\ No newline at end of file
diff --git a/lib/layouts/theorems-ams-bytype.inc b/lib/layouts/theorems-ams-bytype.inc
deleted file mode 100644
index 90e997fc03..0000000000
--- a/lib/layouts/theorems-ams-bytype.inc
+++ /dev/null
@@ -1,341 +0,0 @@
-# Original Author : David L. Johnson <dlj0@lehigh.edu>
-# Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
-# modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
-# Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
-# Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
-# Hacked June '09 by Paul Rubin <rubin@msu.edu> to use separate counters
-
-# The environments defined are :
-# - Theorem
-# - Corollary
-# - Lemma
-# - Proposition
-# - Conjecture
-# - Fact
-# - Definition
-# - Example
-# - Problem
-# - Exercise
-# - Solution
-# - Remark
-# - Claim
-# - Case (by inclusion)
-
-Format 95
-
-Input theorems-counters-bytype.inc
-
-OutlinerName thm "Definitions & Theorems"
-
-Style Theorem
-	Category              Reasoning
-	Margin                First_Dynamic
-	LatexType             Environment
-	LatexName             thm
-	NextNoIndent          1
-	ResetArgs             1
-	AddToToc              thm
-	IsTocCaption          1
-	Argument 1
-		LabelString    "Additional Theorem Text"
-		Tooltip        "Additional text appended to the theorem header"
-		IsTocCaption      1
-	EndArgument
-	LabelSep              xx
-	ParIndent             MMM
-	ParSkip               0.4
-	ItemSep               0.2
-	TopSep                0.7
-	BottomSep             0.7
-	ParSep                0.3
-	Align                 Block
-	AlignPossible         Left
-	LabelType             Static
-	LabelCounter          theorem
-	LabelString           "Theorem \thetheorem."
-	Font
-	  Shape               Italic
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-		\theoremstyle{plain}
-		\newtheorem{thm}{\protect\theoremname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\theoremname}{_(Theorem)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
-	EndBabelPreamble
-	Requires              amsthm
-	DocBookTag            para
-	DocBookAttr           role='theorem'
-End
-
-
-Style Corollary
-	CopyStyle             Theorem
-	LatexName             cor
-	LabelString           "Corollary \thecorollary."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{cor}{\protect\corollaryname}
-	EndPreamble
-	LabelCounter          corollary
-	LangPreamble
-		\providecommand{\corollaryname}{_(Corollary)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='corollary'
-End
-
-
-Style Lemma
-	CopyStyle             Theorem
-	LatexName             lem
-	LabelString           "Lemma \thelemma."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{lem}{\protect\lemmaname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\lemmaname}{_(Lemma)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
-	EndBabelPreamble
-	LabelCounter          lemma
-	DocBookTag            para
-	DocBookAttr           role='lemma'
-End
-
-
-Style Proposition
-	CopyStyle             Theorem
-	LatexName             prop
-	LabelString           "Proposition \theproposition."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{prop}{\protect\propositionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\propositionname}{_(Proposition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
-	EndBabelPreamble
-	LabelCounter          proposition
-	DocBookTag            para
-	DocBookAttr           role='proposition'
-End
-
-
-Style Conjecture
-	CopyStyle             Theorem
-	LatexName             conjecture
-	LabelString           "Conjecture \theconjecture."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{conjecture}{\protect\conjecturename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conjecturename}{_(Conjecture)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
-	EndBabelPreamble
-	LabelCounter          conjecture
-	DocBookTag            para
-	DocBookAttr           role='conjecture'
-End
-
-
-Style Fact
-	CopyStyle             Theorem
-	LatexName             fact
-	LabelString           "Fact \thefact."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{fact}{\protect\factname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\factname}{_(Fact)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
-	EndBabelPreamble
-	LabelCounter          fact
-	DocBookTag            para
-	DocBookAttr           role='fact'
-End
-
-
-Style Definition
-	CopyStyle             Theorem
-	LatexName             defn
-	LabelString           "Definition \thedefinition."
-	Font
-	  Shape               Up
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{defn}{\protect\definitionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\definitionname}{_(Definition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
-	EndBabelPreamble
-	LabelCounter          definition
-	DocBookTag            para
-	DocBookAttr           role='definition'
-End
-
-
-Style Example
-	CopyStyle             Definition
-	LatexName             example
-	LabelString           "Example \theexample."
-	Preamble
-	 \theoremstyle{definition}
-	  \newtheorem{example}{\protect\examplename}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\examplename}{_(Example)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
-	EndBabelPreamble
-	LabelCounter          example
-	DocBookWrapperTag     informalexample
-	DocBookTag            para
-	DocBookAttr        ""
-End
-
-
-Style Problem
-	CopyStyle             Definition
-	LatexName             problem
-	LabelString           "Problem \theproblem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{problem}{\protect\problemname}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\problemname}{_(Problem)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
-	EndBabelPreamble
-	LabelCounter          problem
-	DocBookTag            para
-	DocBookAttr           role='problem'
-End
-
-
-Style Exercise
-	CopyStyle             Definition
-	LatexName             xca
-	LabelString           "Exercise \theexercise."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{xca}{\protect\exercisename}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\exercisename}{_(Exercise)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
-	EndBabelPreamble
-	LabelCounter          exercise
-	DocBookTag            para
-	DocBookAttr           role='exercise'
-End
-
-
-Style Solution
-	CopyStyle             Definition
-	LatexName             sol
-	LabelString           "Solution \thesolution."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{sol}{\protect\solutionname}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\solutionname}{_(Solution)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
-	EndBabelPreamble
-	LabelCounter          solution
-	DocBookTag            para
-	DocBookAttr           role='solution'
-End
-
-
-Style Remark
-	CopyStyle             Theorem
-	LatexName             rem
-	LabelString           "Remark \theremark."
-	Font
-	  Shape               Up
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Series              Medium
-	  Shape               Italic
-	EndFont
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{rem}{\protect\remarkname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\remarkname}{_(Remark)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
-	EndBabelPreamble
-	LabelCounter          remark
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Claim
-	CopyStyle             Remark
-	LatexName             claim
-	LabelString           "Claim \theclaim."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{claim}{\protect\claimname}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\claimname}{_(Claim)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
-	EndBabelPreamble
-	LabelCounter          claim
-	DocBookTag            para
-	DocBookAttr           role='claim'
-	DocBookItemTag        ""
-End
-
-Input theorems-case.inc
diff --git a/lib/layouts/theorems-ams-bytype.module b/lib/layouts/theorems-ams-bytype.module
index 0a4f7e78a7..ea50afd097 100644
--- a/lib/layouts/theorems-ams-bytype.module
+++ b/lib/layouts/theorems-ams-bytype.module
@@ -9,7 +9,7 @@
 #The numbering's scope is the whole document. For chapter- and section-wide numbering,
 #use one of the 'within Sections'/'within Chapters' modules, respectively.
 #DescriptionEnd
-#Excludes: theorems-std | theorems-starred | theorems-ams | theorems-bytype
+#Excludes: theorems-std | theorems-ams | theorems-bytype
 
 # Original Author : David L. Johnson <dlj0@lehigh.edu>
 # Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
@@ -17,12 +17,25 @@
 # Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
 # Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
 # Hacked June '09 by Paul Rubin <rubin@msu.edu> to use separate counters
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Requires	amsmath,amsthm
-
-Input theorems-order.inc
-Input theorems-ams-bytype.inc
-Input theorems-starred.inc
+Input theorems-counters-bytype.inc
+Input theorems.inc
+Input theorems-labels.inc
 Input theorems-proof.inc
+
+Style Theorem
+	Preamble
+		\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+		\newcommand\lyx@newtheorem{\@ifstar{\newtheorem*}{\lyx@reg@newtheorem}}
+		\theoremstyle{plain}
+		\newtheorem{thm}{\protect\theoremname}
+	EndPreamble
+	Requires              amsthm
+End
+
+Style Theorem*
+	Requires              amsthm
+End
\ No newline at end of file
diff --git a/lib/layouts/theorems-ams-chap-bytype.inc b/lib/layouts/theorems-ams-chap-bytype.inc
deleted file mode 100644
index a8ea0be05d..0000000000
--- a/lib/layouts/theorems-ams-chap-bytype.inc
+++ /dev/null
@@ -1,436 +0,0 @@
-# Original Author : David L. Johnson <dlj0@lehigh.edu>
-# Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
-# modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
-# Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
-# Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
-# Hacked June '09 by Paul Rubin <rubin@msu.edu> to use separate counters
-# Chapter dependence added Oct '16 by Andrew Parsloe <aparsloe@clear.net.nz>
-
-# The environments defined are :
-# - Theorem
-# - Corollary
-# - Lemma
-# - Proposition
-# - Conjecture
-# - Fact
-# - Definition
-# - Example
-# - Problem
-# - Exercise
-# - Solution
-# - Remark
-# - Claim
-# - Case (by inclusion)
-
-
-Format 95
-
-Input theorems-counters-bytype.inc
-
-Counter theorem
-	Within chapter
-End
-Counter corollary
-	Within chapter
-End
-Counter lemma
-	Within chapter
-End
-Counter proposition
-	Within chapter
-End
-Counter conjecture
-	Within chapter
-End
-Counter fact
-	Within chapter
-End
-Counter definition
-	Within chapter
-End
-Counter example
-	Within chapter
-End
-Counter problem
-	Within chapter
-End
-Counter exercise
-	Within chapter
-End
-Counter solution
-	Within chapter
-End
-Counter remark
-	Within chapter
-End
-Counter claim
-	Within chapter
-End
-
-OutlinerName thm "Definitions & Theorems"
-
-Style Theorem
-	Category              Reasoning
-	Margin                First_Dynamic
-	LatexType             Environment
-	LatexName             thm
-	NextNoIndent          1
-	ResetArgs             1
-	AddToToc              thm
-	IsTocCaption          1
-	Argument 1
-		LabelString    "Additional Theorem Text"
-		Tooltip        "Additional text appended to the theorem header"
-		IsTocCaption      1
-	EndArgument
-	LabelSep              xx
-	ParIndent             MMM
-	ParSkip               0.4
-	ItemSep               0.2
-	TopSep                0.7
-	BottomSep             0.7
-	ParSep                0.3
-	Align                 Block
-	AlignPossible         Left
-	LabelType             Static
-	LabelCounter          theorem
-	LabelString           "Theorem \thetheorem."
-	Font
-	  Shape               Italic
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-		\theoremstyle{plain}
-    \ifx\thechapter\undefined
-	    \newtheorem{thm}{\protect\theoremname}
-	  \else
-      \newtheorem{thm}{\protect\theoremname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-		\providecommand{\theoremname}{_(Theorem)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
-	EndBabelPreamble
-	Requires              amsthm
-	DocBookTag            para
-	DocBookAttr           role='theorem'
-End
-
-
-Style Corollary
-	CopyStyle             Theorem
-	LatexName             cor
-	LabelString           "Corollary \thecorollary."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-	    \newtheorem{cor}{\protect\corollaryname}
-	  \else
-      \newtheorem{cor}{\protect\corollaryname}[chapter]
-    \fi
-	EndPreamble
-	LabelCounter          corollary
-	LangPreamble
-		\providecommand{\corollaryname}{_(Corollary)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='corollary'
-End
-
-
-Style Lemma
-	CopyStyle             Theorem
-	LatexName             lem
-	LabelString           "Lemma \thelemma."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{lem}{\protect\lemmaname}
-    \else
-      \newtheorem{lem}{\protect\lemmaname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\lemmaname}{_(Lemma)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
-	EndBabelPreamble
-	LabelCounter          lemma
-	DocBookTag            para
-	DocBookAttr           role='lemma'
-End
-
-
-Style Proposition
-	CopyStyle             Theorem
-	LatexName             prop
-	LabelString           "Proposition \theproposition."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{prop}{\protect\propositionname}
-    \else
-      \newtheorem{prop}{\protect\propositionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\propositionname}{_(Proposition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
-	EndBabelPreamble
-	LabelCounter          proposition
-	DocBookTag            para
-	DocBookAttr           role='proposition'
-End
-
-
-Style Conjecture
-	CopyStyle             Theorem
-	LatexName             conjecture
-	LabelString           "Conjecture \theconjecture."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{conjecture}{\protect\conjecturename}
-    \else
-      \newtheorem{conjecture}{\protect\conjecturename}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conjecturename}{_(Conjecture)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
-	EndBabelPreamble
-	LabelCounter          conjecture
-	DocBookTag            para
-	DocBookAttr           role='conjecture'
-End
-
-
-Style Fact
-	CopyStyle             Theorem
-	LatexName             fact
-	LabelString           "Fact \thefact."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{fact}{\protect\factname}
-    \else
-      \newtheorem{fact}{\protect\factname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\factname}{_(Fact)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
-	EndBabelPreamble
-	LabelCounter          fact
-	DocBookTag            para
-	DocBookAttr           role='fact'
-End
-
-
-Style Definition
-	CopyStyle             Theorem
-	LatexName             defn
-	LabelString           "Definition \thedefinition."
-	Font
-	  Shape               Up
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	  \theoremstyle{definition}
-    \ifx\thechapter\undefined
-      \newtheorem{defn}{\protect\definitionname}
-    \else
-      \newtheorem{defn}{\protect\definitionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\definitionname}{_(Definition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
-	EndBabelPreamble
-	LabelCounter          definition
-	DocBookTag            para
-	DocBookAttr           role='definition'
-End
-
-
-Style Example
-	CopyStyle             Definition
-	LatexName             example
-	LabelString           "Example \theexample."
-	Preamble
-	  \theoremstyle{definition}
-    \ifx\thechapter\undefined
-      \newtheorem{example}{\protect\examplename}
-    \else
-      \newtheorem{example}{\protect\examplename}[chapter]
-    \fi
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\examplename}{_(Example)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
-	EndBabelPreamble
-	LabelCounter          example
-	DocBookWrapperTag     informalexample
-	DocBookTag            para
-	DocBookAttr        ""
-End
-
-
-Style Problem
-	CopyStyle             Definition
-	LatexName             problem
-	LabelString           "Problem \theproblem."
-	Preamble
-	  \theoremstyle{definition}
-    \ifx\thechapter\undefined
-      \newtheorem{problem}{\protect\problemname}
-    \else
-      \newtheorem{problem}{\protect\problemname}[chapter]
-    \fi
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\problemname}{_(Problem)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
-	EndBabelPreamble
-	LabelCounter          problem
-	DocBookTag            para
-	DocBookAttr           role='problem'
-End
-
-
-Style Exercise
-	CopyStyle             Definition
-	LatexName             xca
-	LabelString           "Exercise \theexercise."
-	Preamble
-	  \theoremstyle{definition}
-    \ifx\thechapter\undefined
-      \newtheorem{xca}{\protect\exercisename}
-    \else
-      \newtheorem{xca}{\protect\exercisename}[chapter]
-    \fi
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\exercisename}{_(Exercise)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
-	EndBabelPreamble
-	LabelCounter          exercise
-	DocBookTag            para
-	DocBookAttr           role='exercise'
-End
-
-
-Style Solution
-	CopyStyle             Definition
-	LatexName             sol
-	LabelString           "Solution \thesolution."
-	Preamble
-	  \theoremstyle{definition}
-    \ifx\thechapter\undefined
-      \newtheorem{sol}{\protect\solutionname}
-    \else
-      \newtheorem{sol}{\protect\solutionname}[chapter]
-    \fi
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\solutionname}{_(Solution)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
-	EndBabelPreamble
-	LabelCounter          solution
-	DocBookTag            para
-	DocBookAttr           role='solution'
-End
-
-
-Style Remark
-	CopyStyle             Theorem
-	LatexName             rem
-	LabelString           "Remark \theremark."
-	Font
-	  Shape               Up
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Series              Medium
-	  Shape               Italic
-	EndFont
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{rem}{\protect\remarkname}
-    \else
-      \newtheorem{rem}{\protect\remarkname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\remarkname}{_(Remark)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
-	EndBabelPreamble
-	LabelCounter          remark
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Claim
-	CopyStyle             Remark
-	LatexName             claim
-	LabelString           "Claim \theclaim."
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{claim}{\protect\claimname}
-    \else
-      \newtheorem{claim}{\protect\claimname}[chapter]
-    \fi
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-	  \providecommand{\claimname}{_(Claim)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
-	EndBabelPreamble
-	LabelCounter          claim
-	DocBookTag            para
-	DocBookAttr           role='claim'
-	DocBookItemTag        ""
-End
-
-
-Input theorems-case.inc
diff --git a/lib/layouts/theorems-ams-chap-bytype.module b/lib/layouts/theorems-ams-chap-bytype.module
index 54855243e4..a793ce826b 100644
--- a/lib/layouts/theorems-ams-chap-bytype.module
+++ b/lib/layouts/theorems-ams-chap-bytype.module
@@ -9,7 +9,8 @@
 #proposition 4, ...). The numbering restarts for each chapter: theorem 1.1,
 #theorem 2.1, ...
 #DescriptionEnd
-#Excludes: theorems-std | theorems-starred | theorems-ams | theorems-bytype
+#Requires: theorems-ams-bytype
+#Excludes: theorems-ams-extended-bytype
 
 # Original Author : David L. Johnson <dlj0@lehigh.edu>
 # Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
@@ -18,12 +19,25 @@
 # Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
 # Hacked June '09 by Paul Rubin <rubin@msu.edu> to use separate counters
 # Chapter dependence added Oct '16 by Andrew Parsloe <aparsloe@clear.net.nz>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Requires	amsmath,amsthm
-
-Input theorems-order.inc
-Input theorems-ams-chap-bytype.inc
-Input theorems-starred.inc
-Input theorems-proof.inc
+Style Theorem
+	Preamble
+		\newcommand\lyx@newtheorem{\@ifstar{\newtheorem*}{\lyx@reg@newtheorem}}
+		\theoremstyle{plain}
+		\ifcsname c@chapter\endcsname
+			\ifx\c@chapter\relax
+				\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+				\newtheorem{thm}{\protect\theoremname}
+			\else
+				\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}[chapter]}
+				\newtheorem{thm}{\protect\theoremname}[chapter]
+			\fi
+		\else
+			\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+			\newtheorem{thm}{\protect\theoremname}
+		\fi
+	EndPreamble
+End
diff --git a/lib/layouts/theorems-ams-extended-bytype.module b/lib/layouts/theorems-ams-extended-bytype.module
index 6f30ef9add..1752f88011 100644
--- a/lib/layouts/theorems-ams-extended-bytype.module
+++ b/lib/layouts/theorems-ams-extended-bytype.module
@@ -21,8 +21,6 @@
 
 Format 95
 
-Requires	amsmath
-
 # The environnements defined (regular and starred) are :
 # - Criterion
 # - Algorithm
@@ -37,451 +35,5 @@ Requires	amsmath
 # - Question
 
 Input theorems-counters-extended-bytype.inc
-
-Style Criterion
-	CopyStyle             Theorem
-	LatexName             criterion
-	LabelString           "Criterion \thecriterion."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{criterion}{\protect\criterionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\criterionname}{_(Criterion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
-	EndBabelPreamble
-	LabelCounter          criterion
-	DocBookTag            para
-	DocBookAttr           role='criterion'
-	DocBookItemTag        ""
-End
-
-Style Criterion*
-	CopyStyle             Theorem*
-	LatexName             criterion*
-	LabelString           "Criterion."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{criterion*}{\protect\criterionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\criterionname}{_(Criterion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='criterion'
-	DocBookItemTag        ""
-End
-
-
-Style Algorithm
-	CopyStyle             Theorem
-	LatexName             lyxalgorithm
-	LabelString           "Algorithm \thealgorithm."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{lyxalgorithm}{\protect\algorithmname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\algorithmname}{_(Algorithm)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
-	EndBabelPreamble
-	LabelCounter          algorithm
-	DocBookTag            para
-	DocBookAttr           role='algorithm'
-	DocBookItemTag        ""
-End
-
-
-Style Algorithm*
-	CopyStyle             Theorem*
-	LatexName             lyxalgorithm*
-	LabelString           "Algorithm."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{lyxalgorithm*}{\protect\algorithmname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\algorithmname}{_(Algorithm)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='algorithm'
-	DocBookItemTag        ""
-End
-
-
-Style Axiom
-	CopyStyle             Theorem
-	LatexName             ax
-	LabelString           "Axiom \theaxiom."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{ax}{\protect\axiomname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\axiomname}{_(Axiom)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
-	EndBabelPreamble
-	LabelCounter          axiom
-	DocBookTag            para
-	DocBookAttr           role='axiom'
-	DocBookItemTag        ""
-End
-
-
-Style Axiom*
-	CopyStyle             Theorem*
-	LatexName             ax*
-	LabelString           "Axiom."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{ax*}{\protect\axiomname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\axiomname}{_(Axiom)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='axiom'
-	DocBookItemTag        ""
-End
-
-
-Style Condition
-	CopyStyle             Definition
-	LatexName             condition
-	LabelString           "Condition \thecondition."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{condition}{\protect\conditionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conditionname}{_(Condition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
-	EndBabelPreamble
-	LabelCounter          condition
-	DocBookTag            para
-	DocBookAttr           role='condition'
-	DocBookItemTag        ""
-End
-
-
-Style Condition*
-	CopyStyle             Definition*
-	LatexName             condition*
-	LabelString           "Condition."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{condition*}{\protect\conditionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conditionname}{_(Condition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='condition'
-	DocBookItemTag        ""
-End
-
-
-Style Note
-	CopyStyle             Remark
-	LatexName             note
-	LabelString           "Note \thenote."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{note}{\protect\notename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notename}{_(Note)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
-	EndBabelPreamble
-	LabelCounter          note
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Note*
-	CopyStyle             Remark*
-	LatexName             note*
-	LabelString           "Note."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{note*}{\protect\notename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notename}{_(Note)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
-	EndBabelPreamble
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Notation
-	CopyStyle             Remark
-	LatexName             notation
-	LabelString           "Notation \thenotation."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{notation}{\protect\notationname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notationname}{_(Notation)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
-	EndBabelPreamble
-	LabelCounter          notation
-	DocBookTag            para
-	DocBookAttr           role='notation'
-	DocBookItemTag        ""
-End
-
-
-Style Notation*
-	CopyStyle             Remark*
-	LatexName             notation*
-	LabelString           "Notation."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{notation*}{\protect\notationname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notationname}{_(Notation)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='notation'
-	DocBookItemTag        ""
-End
-
-
-Style Summary
-	CopyStyle             Remark
-	LatexName             summary
-	LabelString           "Summary \thesummary."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{summary}{\protect\summaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\summaryname}{_(Summary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
-	EndBabelPreamble
-	LabelCounter          summary
-	DocBookTag            para
-	DocBookAttr           role='summary'
-	DocBookItemTag        ""
-End
-
-
-Style Summary*
-	CopyStyle             Remark*
-	LatexName             summary*
-	LabelString           "Summary."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{summary*}{\protect\summaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\summaryname}{_(Summary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='summary'
-	DocBookItemTag        ""
-End
-
-
-Style Acknowledgement
-	CopyStyle             Remark
-	LatexName             acknowledgement
-	LabelString           "Acknowledgement \theacknowledgement."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{acknowledgement}{\protect\acknowledgementname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
-	EndBabelPreamble
-	LabelCounter          acknowledgement
-	DocBookTag            para
-	DocBookAttr           role='acknowledgement'
-	DocBookItemTag        ""
-End
-
-
-Style Acknowledgement*
-	CopyStyle             Remark*
-	LatexName             acknowledgement*
-	LabelString           "Acknowledgement."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{acknowledgement*}{\protect\acknowledgementname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='acknowledgement'
-	DocBookItemTag        ""
-End
-
-
-Style Conclusion
-	CopyStyle             Remark
-	LatexName             conclusion
-	LabelString           "Conclusion \theconclusion."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{conclusion}{\protect\conclusionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conclusionname}{_(Conclusion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
-	EndBabelPreamble
-	LabelCounter          conclusion
-	DocBookTag            para
-	DocBookAttr           role='conclusion'
-	DocBookItemTag        ""
-End
-
-
-Style Conclusion*
-	CopyStyle             Remark*
-	LatexName             conclusion*
-	LabelString           "Conclusion."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{conclusion*}{\protect\conclusionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conclusionname}{_(Conclusion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='conclusion'
-	DocBookItemTag        ""
-End
-
-
-Style Assumption
-	CopyStyle             Theorem
-	LatexName             assumption
-	LabelString           "Assumption \theassumption."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{assumption}{\protect\assumptionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\assumptionname}{_(Assumption)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
-	EndBabelPreamble
-	LabelCounter          assumption
-	DocBookTag            para
-	DocBookAttr           role='assumption'
-	DocBookItemTag        ""
-End
-
-
-Style Assumption*
-	CopyStyle             Theorem*
-	LatexName             assumption*
-	LabelString           "Assumption."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{assumption*}{\protect\assumptionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\assumptionname}{_(Assumption)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='assumption'
-	DocBookItemTag        ""
-End
-
-Style Question
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             question
-	LabelString           "Question \thequestion."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{question}{\protect\questionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\questionname}{_(Question)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
-	EndBabelPreamble
-	LabelCounter          question
-	DocBookTag            para
-	DocBookAttr           role='question'
-	DocBookItemTag        ""
-End
-
-Style Question*
-	CopyStyle             Theorem*
-	LatexName             question*
-	LabelString           "Question."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{question*}{\protect\questionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\questionname}{_(Question)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='question'
-	DocBookItemTag        ""
-End
-
-Input theorems-refprefix.inc
+Input theorems-extended.inc
+Input theorems-labels.inc
diff --git a/lib/layouts/theorems-ams-extended-chap-bytype.module b/lib/layouts/theorems-ams-extended-chap-bytype.module
index faab7072e9..ddf59a30a1 100644
--- a/lib/layouts/theorems-ams-extended-chap-bytype.module
+++ b/lib/layouts/theorems-ams-extended-chap-bytype.module
@@ -19,11 +19,10 @@
 # Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
 # Hacked June '09 by Paul Rubin <rubin@msu.edu> to use separate counters
 # Chapter dependence added Oct '16 by Andrew Parsloe <aparsloe@clear.net.nz>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Requires	amsmath
-
 # The environnements defined (regular and starred) are :
 # - Criterion
 # - Algorithm
@@ -75,496 +74,5 @@ End
 
 # additional (AMS-extended) environments
 
-Style Criterion
-	CopyStyle             Theorem
-	LatexName             criterion
-	LabelString           "Criterion \thecriterion."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{criterion}{\protect\criterionname}
-    \else
-      \newtheorem{criterion}{\protect\criterionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\criterionname}{_(Criterion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
-	EndBabelPreamble
-	LabelCounter          criterion
-	DocBookTag            para
-	DocBookAttr           role='criterion'
-	DocBookItemTag        ""
-End
-
-
-Style Criterion*
-	CopyStyle             Theorem*
-	LatexName             criterion*
-	LabelString           "Criterion."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{criterion*}{\protect\criterionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\criterionname}{_(Criterion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='criterion'
-	DocBookItemTag        ""
-End
-
-
-Style Algorithm
-	CopyStyle             Theorem
-	LatexName             lyxalgorithm
-	LabelString           "Algorithm \thealgorithm."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{lyxalgorithm}{\protect\algorithmname}
-    \else
-      \newtheorem{lyxalgorithm}{\protect\algorithmname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\algorithmname}{_(Algorithm)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
-	EndBabelPreamble
-	LabelCounter          algorithm
-	DocBookTag            para
-	DocBookAttr           role='algorithm'
-	DocBookItemTag        ""
-End
-
-
-Style Algorithm*
-	CopyStyle             Theorem*
-	LatexName             lyxalgorithm*
-	LabelString           "Algorithm."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{lyxalgorithm*}{\protect\algorithmname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\algorithmname}{_(Algorithm)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='algorithm'
-	DocBookItemTag        ""
-End
-
-
-Style Axiom
-	CopyStyle             Theorem
-	LatexName             ax
-	LabelString           "Axiom \theaxiom."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{ax}{\protect\axiomname}
-    \else
-      \newtheorem{ax}{\protect\axiomname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\axiomname}{_(Axiom)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
-	EndBabelPreamble
-	LabelCounter          axiom
-	DocBookTag            para
-	DocBookAttr           role='axiom'
-	DocBookItemTag        ""
-End
-
-
-Style Axiom*
-	CopyStyle             Theorem*
-	LatexName             ax*
-	LabelString           "Axiom."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{ax*}{\protect\axiomname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\axiomname}{_(Axiom)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='axiom'
-	DocBookItemTag        ""
-End
-
-
-Style Condition
-	CopyStyle             Definition
-	LatexName             condition
-	LabelString           "Condition \thecondition."
-	Preamble
-	  \theoremstyle{definition}
-    \ifx\thechapter\undefined
-      \newtheorem{condition}{\protect\conditionname}
-    \else
-      \newtheorem{condition}{\protect\conditionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conditionname}{_(Condition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
-	EndBabelPreamble
-	LabelCounter          condition
-	DocBookTag            para
-	DocBookAttr           role='condition'
-	DocBookItemTag        ""
-End
-
-
-Style Condition*
-	CopyStyle             Definition*
-	LatexName             condition*
-	LabelString           "Condition."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{condition*}{\protect\conditionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conditionname}{_(Condition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='condition'
-	DocBookItemTag        ""
-End
-
-
-Style Note
-	CopyStyle             Remark
-	LatexName             note
-	LabelString           "Note \thenote."
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{note}{\protect\notename}
-    \else
-      \newtheorem{note}{\protect\notename}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notename}{_(Note)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
-	EndBabelPreamble
-	LabelCounter          note
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Note*
-	CopyStyle             Remark*
-	LatexName             note*
-	LabelString           "Note."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{note*}{\protect\notename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notename}{_(Note)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
-	EndBabelPreamble
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Notation
-	CopyStyle             Remark
-	LatexName             notation
-	LabelString           "Notation \thenotation."
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{notation}{\protect\notationname}
-    \else
-      \newtheorem{notation}{\protect\notationname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notationname}{_(Notation)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
-	EndBabelPreamble
-	LabelCounter          notation
-	DocBookTag            para
-	DocBookAttr           role='notation'
-	DocBookItemTag        ""
-End
-
-
-Style Notation*
-	CopyStyle             Remark*
-	LatexName             notation*
-	LabelString           "Notation."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{notation*}{\protect\notationname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notationname}{_(Notation)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='notation'
-	DocBookItemTag        ""
-End
-
-
-Style Summary
-	CopyStyle             Remark
-	LatexName             summary
-	LabelString           "Summary \thesummary."
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{summary}{\protect\summaryname}
-    \fi
-    \else
-      \newtheorem{summary}{\protect\summaryname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\summaryname}{_(Summary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
-	EndBabelPreamble
-	LabelCounter          summary
-	DocBookTag            para
-	DocBookAttr           role='summary'
-	DocBookItemTag        ""
-End
-
-
-Style Summary*
-	CopyStyle             Remark*
-	LatexName             summary*
-	LabelString           "Summary."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{summary*}{\protect\summaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\summaryname}{_(Summary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='summary'
-	DocBookItemTag        ""
-End
-
-
-Style Acknowledgement
-	CopyStyle             Remark
-	LatexName             acknowledgement
-	LabelString           "Acknowledgement \theacknowledgement."
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{acknowledgement}{\protect\acknowledgementname}
-    \else
-      \newtheorem{acknowledgement}{\protect\acknowledgementname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
-	EndBabelPreamble
-	LabelCounter          acknowledgement
-	DocBookTag            para
-	DocBookAttr           role='acknowledgement'
-	DocBookItemTag        ""
-End
-
-
-Style Acknowledgement*
-	CopyStyle             Remark*
-	LatexName             acknowledgement*
-	LabelString           "Acknowledgement."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{acknowledgement*}{\protect\acknowledgementname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='acknowledgement'
-	DocBookItemTag        ""
-End
-
-
-Style Conclusion
-	CopyStyle             Remark
-	LatexName             conclusion
-	LabelString           "Conclusion \theconclusion."
-	Preamble
-	  \theoremstyle{remark}
-    \ifx\thechapter\undefined
-      \newtheorem{conclusion}{\protect\conclusionname}
-    \else
-      \newtheorem{conclusion}{\protect\conclusionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conclusionname}{_(Conclusion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
-	EndBabelPreamble
-	LabelCounter          conclusion
-	DocBookTag            para
-	DocBookAttr           role='conclusion'
-	DocBookItemTag        ""
-End
-
-
-Style Conclusion*
-	CopyStyle             Remark*
-	LatexName             conclusion*
-	LabelString           "Conclusion."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{conclusion*}{\protect\conclusionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conclusionname}{_(Conclusion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='conclusion'
-	DocBookItemTag        ""
-End
-
-
-Style Assumption
-	CopyStyle             Theorem
-	LatexName             assumption
-	LabelString           "Assumption \theassumption."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{assumption}{\protect\assumptionname}
-    \else
-      \newtheorem{assumption}{\protect\assumptionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\assumptionname}{_(Assumption)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
-	EndBabelPreamble
-	LabelCounter          assumption
-	DocBookTag            para
-	DocBookAttr           role='assumption'
-	DocBookItemTag        ""
-End
-
-
-Style Assumption*
-	CopyStyle             Theorem*
-	LatexName             assumption*
-	LabelString           "Assumption."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{assumption*}{\protect\assumptionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\assumptionname}{_(Assumption)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='assumption'
-	DocBookItemTag        ""
-End
-
-Style Question
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             question
-	LabelString           "Question \thequestion."
-	Preamble
-	  \theoremstyle{plain}
-    \ifx\thechapter\undefined
-      \newtheorem{question}{\protect\questionname}
-    \else
-      \newtheorem{question}{\protect\questionname}[chapter]
-    \fi
-	EndPreamble
-	LangPreamble
-	  \providecommand{\questionname}{_(Question)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
-	EndBabelPreamble
-	LabelCounter          question
-	DocBookTag            para
-	DocBookAttr           role='question'
-	DocBookItemTag        ""
-End
-
-Style Question*
-	CopyStyle             Theorem*
-	LatexName             question*
-	LabelString           "Question."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{question*}{\protect\questionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\questionname}{_(Question)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='question'
-	DocBookItemTag        ""
-End
-
-Input theorems-refprefix.inc
+Input theorems-extended.inc
+Input theorems-labels.inc
diff --git a/lib/layouts/theorems-ams-extended.module b/lib/layouts/theorems-ams-extended.module
index 6efe465667..a331a08e97 100644
--- a/lib/layouts/theorems-ams-extended.module
+++ b/lib/layouts/theorems-ams-extended.module
@@ -14,11 +14,10 @@
 # modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
 # Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
 # Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Requires	amsmath
-
 # The environments defined (regular and starred) are :
 # - Criterion
 # - Algorithm
@@ -33,443 +32,5 @@ Requires	amsmath
 # - Assumption
 # - Question
 
-Style Criterion
-	CopyStyle             Theorem
-	DependsOn	            Theorem
-	LatexName             criterion
-	LabelString           "Criterion \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{criterion}[thm]{\protect\criterionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\criterionname}{_(Criterion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='criterion'
-	DocBookItemTag        ""
-End
-
-Style Criterion*
-	CopyStyle             Theorem*
-	LatexName             criterion*
-	LabelString           "Criterion."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{criterion*}{\protect\criterionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\criterionname}{_(Criterion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='criterion'
-	DocBookItemTag        ""
-End
-
-
-Style Algorithm
-	CopyStyle             Theorem
-	DependsOn	           Theorem
-	LatexName             lyxalgorithm
-	LabelString           "Algorithm \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{lyxalgorithm}[thm]{\protect\algorithmname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\algorithmname}{_(Algorithm)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='algorithm'
-	DocBookItemTag        ""
-End
-
-
-Style Algorithm*
-	CopyStyle             Theorem*
-	LatexName             lyxalgorithm*
-	LabelString           "Algorithm."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{lyxalgorithm*}{\protect\algorithmname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\algorithmname}{_(Algorithm)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='algorithm'
-	DocBookItemTag        ""
-End
-
-
-Style Axiom
-	CopyStyle             Theorem
-	DependsOn	            Theorem
-	LatexName             ax
-	LabelString           "Axiom \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{ax}[thm]{\protect\axiomname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\axiomname}{_(Axiom)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='axiom'
-	DocBookItemTag        ""
-End
-
-
-Style Axiom*
-	CopyStyle             Theorem*
-	LatexName             ax*
-	LabelString           "Axiom."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{ax*}{\protect\axiomname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\axiomname}{_(Axiom)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='axiom'
-	DocBookItemTag        ""
-End
-
-
-Style Condition
-	CopyStyle             Definition
-	LatexName             condition
-	LabelString           "Condition \thetheorem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{condition}[thm]{\protect\conditionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conditionname}{_(Condition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='condition'
-	DocBookItemTag        ""
-End
-
-
-Style Condition*
-	CopyStyle             Definition*
-	LatexName             condition*
-	LabelString           "Condition."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{condition*}{\protect\conditionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conditionname}{_(Condition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='condition'
-	DocBookItemTag        ""
-End
-
-
-Style Note
-	CopyStyle             Remark
-	LatexName             note
-	LabelString           "Note \thetheorem."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{note}[thm]{\protect\notename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notename}{_(Note)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
-	EndBabelPreamble
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Note*
-	CopyStyle             Remark*
-	LatexName             note*
-	LabelString           "Note."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{note*}{\protect\notename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notename}{_(Note)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
-	EndBabelPreamble
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Notation
-	CopyStyle             Remark
-	LatexName             notation
-	LabelString           "Notation \thetheorem."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{notation}[thm]{\protect\notationname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notationname}{_(Notation)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='notation'
-	DocBookItemTag        ""
-End
-
-
-Style Notation*
-	CopyStyle             Remark*
-	LatexName             notation*
-	LabelString           "Notation."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{notation*}{\protect\notationname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\notationname}{_(Notation)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='notation'
-	DocBookItemTag        ""
-End
-
-
-Style Summary
-	CopyStyle             Remark
-	LatexName             summary
-	LabelString           "Summary \thetheorem."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{summary}[thm]{\protect\summaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\summaryname}{_(Summary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='summary'
-	DocBookItemTag        ""
-End
-
-
-Style Summary*
-	CopyStyle             Remark*
-	LatexName             summary*
-	LabelString           "Summary."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{summary*}{\protect\summaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\summaryname}{_(Summary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='summary'
-	DocBookItemTag        ""
-End
-
-
-Style Acknowledgement
-	CopyStyle             Remark
-	LatexName             acknowledgement
-	LabelString           "Acknowledgement \thetheorem."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{acknowledgement}[thm]{\protect\acknowledgementname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='acknowledgement'
-	DocBookItemTag        ""
-End
-
-
-Style Acknowledgement*
-	CopyStyle             Remark*
-	LatexName             acknowledgement*
-	LabelString           "Acknowledgement."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{acknowledgement*}{\protect\acknowledgementname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='acknowledgement'
-	DocBookItemTag        ""
-End
-
-
-Style Conclusion
-	CopyStyle             Remark
-	LatexName             conclusion
-	LabelString           "Conclusion \thetheorem."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{conclusion}[thm]{\protect\conclusionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conclusionname}{_(Conclusion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='conclusion'
-	DocBookItemTag        ""
-End
-
-
-Style Conclusion*
-	CopyStyle             Remark*
-	LatexName             conclusion*
-	LabelString           "Conclusion."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{conclusion*}{\protect\conclusionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conclusionname}{_(Conclusion)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='conclusion'
-	DocBookItemTag        ""
-End
-
-
-Style Assumption
-	CopyStyle             Theorem
-	DependsOn	            Theorem
-	LatexName             assumption
-	LabelString           "Assumption \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{assumption}[thm]{\protect\assumptionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\assumptionname}{_(Assumption)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='assumption'
-	DocBookItemTag        ""
-End
-
-
-Style Assumption*
-	CopyStyle             Theorem*
-	LatexName             assumption*
-	LabelString           "Assumption."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{assumption*}{\protect\assumptionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\assumptionname}{_(Assumption)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='assumption'
-	DocBookItemTag        ""
-End
-
-Style Question
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             question
-	LabelString           "Question \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{question}[thm]{\protect\questionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\questionname}{_(Question)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='question'
-	DocBookItemTag        ""
-End
-
-Style Question*
-	CopyStyle             Theorem*
-	LatexName             question*
-	LabelString           "Question."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{question*}{\protect\questionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\questionname}{_(Question)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='question'
-	DocBookItemTag        ""
-End
-
-Input theorems-refprefix.inc
+Input theorems-counters-extended-bytype
+Input theorems-extended.inc
diff --git a/lib/layouts/theorems-ams.inc b/lib/layouts/theorems-ams.inc
deleted file mode 100644
index 9718b2fe68..0000000000
--- a/lib/layouts/theorems-ams.inc
+++ /dev/null
@@ -1,329 +0,0 @@
-# Original Author : David L. Johnson <dlj0@lehigh.edu>
-# Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
-# modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
-# Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
-# Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
-
-# The environments defined are :
-# - Theorem
-# - Corollary
-# - Lemma
-# - Proposition
-# - Conjecture
-# - Definition
-# - Example
-# - Problem
-# - Exercise
-# - Solution
-# - Remark
-# - Claim
-# - Proof
-# - Case (by inclusion)
-
-Format 95
-
-OutlinerName thm "Definitions & Theorems"
-
-Style Theorem
-	Category              Reasoning
-	Margin                First_Dynamic
-	LatexType             Environment
-	LatexName             thm
-	NextNoIndent          0
-	ResetArgs             1
-	AddToToc              thm
-	IsTocCaption          1
-	Argument 1
-		LabelString    "Additional Theorem Text"
-		Tooltip        "Additional text appended to the theorem header"
-		IsTocCaption      1
-	EndArgument
-	LabelSep              xx
-	ParIndent             MMM
-	ParSkip               0.4
-	ItemSep               0.2
-	TopSep                0.7
-	BottomSep             0.7
-	ParSep                0.3
-	Align                 Block
-	AlignPossible         Left
-	LabelType             Static
-	LabelCounter          theorem
-	LabelString           "Theorem \thetheorem."
-	Font
-	  Shape               Italic
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-		\theoremstyle{plain}
-		\newtheorem{thm}{\protect\theoremname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\theoremname}{_(Theorem)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
-	EndBabelPreamble
-	Requires              amsthm
-	DocBookTag            para
-	DocBookAttr           role='theorem'
-End
-
-
-Style Corollary
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             cor
-	LabelString           "Corollary \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{cor}[thm]{\protect\corollaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\corollaryname}{_(Corollary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='corollary'
-End
-
-
-Style Lemma
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             lem
-	LabelString           "Lemma \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{lem}[thm]{\protect\lemmaname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\lemmaname}{_(Lemma)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='lemma'
-End
-
-
-Style Proposition
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             prop
-	LabelString           "Proposition \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{prop}[thm]{\protect\propositionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\propositionname}{_(Proposition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='proposition'
-End
-
-
-Style Conjecture
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             conjecture
-	LabelString           "Conjecture \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{conjecture}[thm]{\protect\conjecturename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conjecturename}{_(Conjecture)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='conjecture'
-End
-
-
-Style Fact
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             fact
-	LabelString           "Fact \thetheorem."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{fact}[thm]{\protect\factname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\factname}{_(Fact)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='fact'
-End
-
-
-Style Definition
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             defn
-	LabelString           "Definition \thetheorem."
-	Font
-	  Shape               Up
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{defn}[thm]{\protect\definitionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\definitionname}{_(Definition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='definition'
-End
-
-
-Style Example
-	CopyStyle             Definition
-	LatexName             example
-	LabelString           "Example \thetheorem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{example}[thm]{\protect\examplename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\examplename}{_(Example)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
-	EndBabelPreamble
-	DocBookWrapperTag     informalexample
-	DocBookTag            para
-	DocBookAttr           ""
-End
-
-
-Style Problem
-	CopyStyle             Definition
-	LatexName             problem
-	LabelString           "Problem \thetheorem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{problem}[thm]{\protect\problemname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\problemname}{_(Problem)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='problem'
-End
-
-
-Style Exercise
-	CopyStyle             Definition
-	LatexName             xca
-	LabelString           "Exercise \thetheorem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{xca}[thm]{\protect\exercisename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\exercisename}{_(Exercise)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='exercise'
-End
-
-
-Style Solution
-	CopyStyle             Definition
-	LatexName             sol
-	LabelString           "Solution \thetheorem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{sol}[thm]{\protect\solutionname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\solutionname}{_(Solution)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='solution'
-End
-
-
-Style Remark
-	CopyStyle             Theorem
-	DependsOn             Theorem
-	LatexName             rem
-	LabelString           "Remark \thetheorem."
-	Font
-	  Shape               Up
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Series              Medium
-	  Shape               Italic
-	EndFont
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{rem}[thm]{\protect\remarkname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\remarkname}{_(Remark)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
-	EndBabelPreamble
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Claim
-	CopyStyle             Remark
-	LatexName             claim
-	LabelString           "Claim \thetheorem."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{claim}[thm]{\protect\claimname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\claimname}{_(Claim)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='claim'
-	DocBookItemTag        ""
-End
-
-Input theorems-case.inc
-Input theorems-refprefix.inc
diff --git a/lib/layouts/theorems-ams.module b/lib/layouts/theorems-ams.module
index e3282960b8..d7557a9c1a 100644
--- a/lib/layouts/theorems-ams.module
+++ b/lib/layouts/theorems-ams.module
@@ -6,24 +6,29 @@
 #the theorems are numbered consecutively throughout the document. This can be
 #changed by loading one of the 'Theorems (Numbered by ...)' modules.
 #DescriptionEnd
-#Excludes: theorems-std | theorems-starred
+#Excludes: theorems-std | theorems-bytype | theorems-ams-bytype
 
 # Original Author : David L. Johnson <dlj0@lehigh.edu>
 # Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
 # modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
 # Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
 # Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Requires	amsmath,amsthm
-
 Counter theorem
 	GuiName Theorem
 	LaTeXName thm
 End
 
-Input theorems-order.inc
-Input theorems-ams.inc
-Input theorems-starred.inc
+Input theorems.inc
 Input theorems-proof.inc
+
+Style Theorem
+	Requires              amsthm
+End
+
+Style Theorem*
+	Requires              amsthm
+End
diff --git a/lib/layouts/theorems-bytype.inc b/lib/layouts/theorems-bytype.inc
deleted file mode 100644
index deccac3e7a..0000000000
--- a/lib/layouts/theorems-bytype.inc
+++ /dev/null
@@ -1,336 +0,0 @@
-# Original Author : David L. Johnson <dlj0@lehigh.edu>
-# Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
-# modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
-# Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
-# Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
-# Hacked June '09 by Paul Rubin <rubin@msu.edu> to use separate counters
-
-# The environments defined are :
-# - Theorem
-# - Corollary
-# - Lemma
-# - Proposition
-# - Conjecture
-# - Fact
-# - Definition
-# - Example
-# - Problem
-# - Exercise
-# - Solution
-# - Remark
-# - Claim
-# - Proof
-# - Case (by inclusion)
-
-Format 95
-
-Style Theorem
-	Category              Reasoning
-	Margin                First_Dynamic
-	LatexType             Environment
-	LatexName             thm
-	NextNoIndent          1
-	ResetArgs             1
-	Argument 1
-		LabelString    "Additional Theorem Text"
-		Tooltip        "Additional text appended to the theorem header"
-	EndArgument
-	LabelSep              xx
-	ParIndent             MMM
-	ParSkip               0.4
-	ItemSep               0.2
-	TopSep                0.7
-	BottomSep             0.7
-	ParSep                0.3
-	Align                 Block
-	AlignPossible         Left
-	LabelType             Static
-	LabelCounter          theorem
-	LabelString           "Theorem \thetheorem."
-	Font
-	  Shape               Italic
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{thm}{\protect\theoremname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\theoremname}{_(Theorem)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
-	EndBabelPreamble
-	Requires              amsthm
-	DocBookTag            para
-	DocBookAttr           role='theorem'
-End
-
-
-Style Corollary
-	CopyStyle             Theorem
-	LatexName             cor
-	LabelString           "Corollary \thecorollary."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{cor}{\protect\corollaryname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\corollaryname}{_(Corollary)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
-	EndBabelPreamble
-	LabelCounter          corollary
-	DocBookTag            para
-	DocBookAttr           role='corollary'
-End
-
-
-Style Lemma
-	CopyStyle             Theorem
-	LatexName             lem
-	LabelString           "Lemma \thelemma."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{lem}{\protect\lemmaname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\lemmaname}{_(Lemma)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
-	EndBabelPreamble
-	LabelCounter          lemma
-	DocBookTag            para
-	DocBookAttr           role='lemma'
-End
-
-
-Style Proposition
-	CopyStyle             Theorem
-	LatexName             prop
-	LabelString           "Proposition \theproposition."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{prop}{\protect\propositionname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\propositionname}{_(Proposition)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
-	EndBabelPreamble
-	LabelCounter          proposition
-	DocBookTag            para
-	DocBookAttr           role='proposition'
-End
-
-
-Style Conjecture
-	CopyStyle             Theorem
-	LatexName             conjecture
-	LabelString           "Conjecture \theconjecture."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{conjecture}{\protect\conjecturename}
-	EndPreamble
-	LangPreamble
-		\providecommand{\conjecturename}{_(Conjecture)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
-	EndBabelPreamble
-	LabelCounter          conjecture
-	DocBookTag            para
-	DocBookAttr           role='conjecture'
-End
-
-
-Style Fact
-	CopyStyle             Theorem
-	LatexName             fact
-	LabelString           "Fact \thefact."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{fact}{\protect\factname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\factname}{_(Fact)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
-	EndBabelPreamble
-	LabelCounter          fact
-	DocBookTag            para
-	DocBookAttr           role='fact'
-End
-
-
-Style Definition
-	CopyStyle             Theorem
-	LatexName             defn
-	LabelString           "Definition \thedefinition."
-	Font
-	  Shape               Up
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{defn}{\protect\definitionname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\definitionname}{_(Definition)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
-	EndBabelPreamble
-	LabelCounter          definition  
-	DocBookTag            para
-	DocBookAttr           role='definition'
-End
-
-
-Style Example
-	CopyStyle             Definition
-	LatexName             example
-	LabelString           "Example \theexample."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{example}{\protect\examplename}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\examplename}{_(Example)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
-	EndBabelPreamble
-	LabelCounter          example
-	DocBookWrapperTag     informalexample
-	DocBookTag            para
-	DocBookAttr        ""
-End
-
-
-Style Problem
-	CopyStyle             Definition
-	LatexName             problem
-	LabelString           "Problem \theproblem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{problem}{\protect\problemname}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\problemname}{_(Problem)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
-	EndBabelPreamble
-	LabelCounter          problem
-	DocBookTag            para
-	DocBookAttr           role='problem'
-End
-
-
-Style Exercise
-	CopyStyle             Definition
-	LatexName             xca
-	LabelString           "Exercise \theexercise."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{xca}{\protect\exercisename}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\exercisename}{_(Exercise)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
-	EndBabelPreamble
-	LabelCounter          exercise
-	DocBookTag            para
-	DocBookAttr           role='exercise'
-End
-
-
-Style Solution
-	CopyStyle             Definition
-	LatexName             sol
-	LabelString           "Solution \thesolution."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{sol}{\protect\solutionname}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\solutionname}{_(Solution)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
-	EndBabelPreamble
-	LabelCounter          solution
-	DocBookTag            para
-	DocBookAttr           role='solution'
-End
-
-
-Style Remark
-	CopyStyle             Theorem
-	LatexName             rem
-	LabelString           "Remark \theremark."
-	Font
-	  Shape               Up
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Series              Medium
-	  Shape               Italic
-	EndFont
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{rem}{\protect\remarkname}
-	EndPreamble
-	LangPreamble
-		\providecommand{\remarkname}{_(Remark)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
-	EndBabelPreamble
-	LabelCounter          remark
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Claim
-	CopyStyle             Remark
-	LatexName             claim
-	LabelString           "Claim \theclaim."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{claim}{\protect\claimname}
-	EndPreamble
-	Requires              amsthm
-	LangPreamble
-		\providecommand{\claimname}{_(Claim)}
-	EndLangPreamble
-	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
-	EndBabelPreamble
-	LabelCounter          claim
-	DocBookTag            para
-	DocBookAttr           role='claim'
-	DocBookItemTag        ""
-End
-
-Input theorems-case.inc
-Input theorems-refprefix.inc
diff --git a/lib/layouts/theorems-bytype.module b/lib/layouts/theorems-bytype.module
index e2b7428d12..1fb6de3c96 100644
--- a/lib/layouts/theorems-bytype.module
+++ b/lib/layouts/theorems-bytype.module
@@ -8,32 +8,57 @@
 #The numbering's scope is the whole document. For chapter- and section-wide numbering,
 #use one of the 'within Sections'/'within Chapters' modules, respectively.
 #DescriptionEnd
-#Excludes: theorems-std | theorems-ams | theorems-starred | theorems-ams-bytype
+#Excludes: theorems-std | theorems-ams | theorems-ams-bytype
 
 # Author: Paul Rubin <rubin@msu.edu> (hacked from Richard Kimberly Heck's theorems-std.module)
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
 Input theorems-counters-bytype.inc
-Input theorems-bytype.inc
-Input theorems-proof.inc
+Input theorems.inc
+Input theorems-labels.inc
+Input theorems-proof-std.inc
 
-#This is just a hacked version of the AMS proof environment
-Style Proof
-  Preamble
-    \ifx\proof\undefined\
-      \newenvironment{proof}[1][\proofname]{\par
-        \normalfont\topsep6\p@\@plus6\p@\relax
-        \trivlist
-        \itemindent\parindent
-        \item[\hskip\labelsep
-              \scshape
-          #1]\ignorespaces
-      }{%
-        \endtrivlist\@endpefalse
-      }
-      \providecommand{\proofname}{Proof}
-    \fi
-  EndPreamble
-# No LangPreamble or BabelPreamble, since babel knows \proofname already.
+Style Theorem
+	Preamble
+		\def\lyx@reverse@two#1#2{#2#1}
+		\def\lyx@plain{plain}
+		\def\lyx@definition{definition}
+		\def\lyx@remark{remark}
+		\newcommand\theoremstyle[1]{%
+			\def\lyx@style{#1}%
+			\ifx\lyx@style\lyx@plain
+				\def\lyx@headfont{\bfseries}%
+				\def\lyx@bodyfont{\itshape}%
+			\else
+				\ifx\lyx@style\lyx@definition
+					\def\lyx@headfont{\bfseries}%
+					\def\lyx@bodyfont{\upshape}%
+				\else
+					\ifx\lyx@style\lyx@remark
+						\def\lyx@headfont{\itshape}%
+						\def\lyx@bodyfont{\upshape}%
+					\fi
+				\fi
+			\fi
+		}
+		\def\@xthm#1#2{%
+			\@begintheorem{\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}{\begingroup\upshape\csname the#1\endcsname\endgroup.}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\@ythm#1#2[#3]{%
+			\@opargbegintheorem{\normalfont{\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}}{\begingroup\csname lyx@\@firstoftwo#2@headfont\endcsname\upshape\csname the#1\endcsname\endgroup}{#3\lyx@reverse@two{\begingroup\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname.\endgroup}}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\lyx@othm#1[#2]#3{\@othm{#1}[#2]{{#1}{#3}}}
+		\def\lyx@nthm#1#2{\@ifnextchar[{\@xnthm{#1}{{#1}{#2}}}{\@ynthm{#1}{{#1}{#2}}}}
+		\renewcommand\newtheorem[1]{%
+			\expandafter\let\csname lyx@#1@headfont\expandafter\endcsname\lyx@headfont
+			\expandafter\let\csname lyx@#1@bodyfont\expandafter\endcsname\lyx@bodyfont
+			\@ifnextchar[{\lyx@othm{#1}}{\lyx@nthm{#1}}}
+		\newcommand\lyx@starred@newtheorem[2]{\newtheorem{#1}{#2}\expandafter\def\csname the#1\endcsname{\unskip}}
+		\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+		\newcommand\lyx@newtheorem{\@ifstar{\lyx@starred@newtheorem}{\lyx@reg@newtheorem}}
+		\theoremstyle{plain}
+		\newtheorem{thm}{\protect\theoremname}
+	EndPreamble
 End
diff --git a/lib/layouts/theorems-chap-bytype.module b/lib/layouts/theorems-chap-bytype.module
index 2861b740f2..09250db358 100644
--- a/lib/layouts/theorems-chap-bytype.module
+++ b/lib/layouts/theorems-chap-bytype.module
@@ -7,15 +7,14 @@
 #as opposed to theorem 1, theorem 2, lemma 3, proposition 4, ...). The numbering is reset
 #at each chapter start.
 #DescriptionEnd
-#Requires: theorems-bytype | theorems-ams-bytype
-#Excludes: theorems-std | theorems-ams | theorems-starred | theorems-sec | theorems-sec-bytype
+#Requires: theorems-bytype
+#Excludes: theorems-sec-bytype
 
 # Author: Paul Rubin <rubin@msu.edu> (hacked from Richard Kimberly Heck's various modules)
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Input theorems-counters-bytype.inc
-
 Counter theorem
 	Within chapter
 End
@@ -55,143 +54,53 @@ End
 
 Style Theorem
 	Preamble
-	  \theoremstyle{plain}
-	  \ifx\thechapter\undefined
-	    \newtheorem{thm}{\protect\theoremname}
-	  \else
-	    \newtheorem{thm}{\protect\theoremname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Corollary
-	Preamble
-	  \theoremstyle{plain}
-	  \ifx\thechapter\undefined
-	    \newtheorem{cor}{\protect\corollaryname}
-	  \else
-	    \newtheorem{cor}{\protect\corollaryname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Lemma
-	Preamble
-	  \theoremstyle{plain}
-	  \ifx\thechapter\undefined
-	    \newtheorem{lem}{\protect\lemmaname}
-	  \else
-	    \newtheorem{lem}{\protect\lemmaname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Proposition
-	Preamble
-	  \theoremstyle{plain}
-	  \ifx\thechapter\undefined
-	    \newtheorem{prop}{\protect\propositionname}
-	  \else
-	    \newtheorem{prop}{\protect\propositionname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Conjecture
-	Preamble
-	  \theoremstyle{plain}
-	  \ifx\thechapter\undefined
-	    \newtheorem{conjecture}{\protect\conjecturename}
-	  \else
-	    \newtheorem{conjecture}{\protect\conjecturename}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Fact
-	Preamble
-	  \theoremstyle{plain}
-	  \ifx\thechapter\undefined
-	    \newtheorem{fact}{\protect\factname}
-	  \else
-	    \newtheorem{fact}{\protect\factname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Definition
-	Preamble
-	  \theoremstyle{definition}
-	  \ifx\thechapter\undefined
-	    \newtheorem{defn}{\protect\definitionname}
-	  \else
-	    \newtheorem{defn}{\protect\definitionname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Example
-	Preamble
-	  \theoremstyle{definition}
-	  \ifx\thechapter\undefined
-	    \newtheorem{example}{\protect\examplename}
-	  \else
-	    \newtheorem{example}{\protect\examplename}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Problem
-	Preamble
-	  \theoremstyle{definition}
-	  \ifx\thechapter\undefined
-	    \newtheorem{problem}{\protect\problemname}
-	  \else
-	    \newtheorem{problem}{\protect\problemname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Exercise
-	Preamble
-	  \theoremstyle{definition}
-	  \ifx\thechapter\undefined
-	    \newtheorem{xca}{\protect\exercisename}
-	  \else
-	    \newtheorem{xca}{\protect\exercisename}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Remark
-	Preamble
-	  \theoremstyle{remark}
-	  \ifx\thechapter\undefined
-	    \newtheorem{rem}{\protect\remarkname}
-	  \else
-	    \newtheorem{rem}{\protect\remarkname}[chapter]
-	  \fi
-	EndPreamble
-End
-
-
-Style Claim
-	Preamble
-	  \theoremstyle{remark}
-	  \ifx\thechapter\undefined
-	    \newtheorem{claim}{\protect\claimname}
-	  \else
-	    \newtheorem{claim}{\protect\claimname}[chapter]
-	  \fi
+		\def\lyx@reverse@two#1#2{#2#1}
+		\def\lyx@plain{plain}
+		\def\lyx@definition{definition}
+		\def\lyx@remark{remark}
+		\newcommand\theoremstyle[1]{%
+			\def\lyx@style{#1}%
+			\ifx\lyx@style\lyx@plain
+				\def\lyx@headfont{\bfseries}%
+				\def\lyx@bodyfont{\itshape}%
+			\else
+				\ifx\lyx@style\lyx@definition
+					\def\lyx@headfont{\bfseries}%
+					\def\lyx@bodyfont{\upshape}%
+				\else
+					\ifx\lyx@style\lyx@remark
+						\def\lyx@headfont{\itshape}%
+						\def\lyx@bodyfont{\upshape}%
+					\fi
+				\fi
+			\fi
+		}
+		\def\@xthm#1#2{%
+			\@begintheorem{\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}{\begingroup\upshape\csname the#1\endcsname\endgroup.}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\@ythm#1#2[#3]{%
+			\@opargbegintheorem{\normalfont{\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}}{\begingroup\csname lyx@\@firstoftwo#2@headfont\endcsname\upshape\csname the#1\endcsname\endgroup}{#3\lyx@reverse@two{\begingroup\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname.\endgroup}}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\lyx@othm#1[#2]#3{\@othm{#1}[#2]{{#1}{#3}}}
+		\def\lyx@nthm#1#2{\@ifnextchar[{\@xnthm{#1}{{#1}{#2}}}{\@ynthm{#1}{{#1}{#2}}}}
+		\renewcommand\newtheorem[1]{%
+			\expandafter\let\csname lyx@#1@headfont\expandafter\endcsname\lyx@headfont
+			\expandafter\let\csname lyx@#1@bodyfont\expandafter\endcsname\lyx@bodyfont
+			\@ifnextchar[{\lyx@othm{#1}}{\lyx@nthm{#1}}}
+		\newcommand\lyx@starred@newtheorem[2]{\newtheorem{#1}{#2}\expandafter\def\csname the#1\endcsname{\unskip}}
+		\newcommand\lyx@newtheorem{\@ifstar{\lyx@starred@newtheorem}{\lyx@reg@newtheorem}}
+		\theoremstyle{plain}
+		\ifcsname c@chapter\endcsname
+			\ifx\c@chapter\relax
+				\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+				\newtheorem{thm}{\protect\theoremname}
+			\else
+				\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}[chapter]}
+				\newtheorem{thm}{\protect\theoremname}[chapter]
+			\fi
+		\else
+			\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+			\newtheorem{thm}{\protect\theoremname}
+		\fi
 	EndPreamble
 End
diff --git a/lib/layouts/theorems-chap.module b/lib/layouts/theorems-chap.module
index 8fffe4d798..f6625ba7d3 100644
--- a/lib/layouts/theorems-chap.module
+++ b/lib/layouts/theorems-chap.module
@@ -5,10 +5,11 @@
 #each chapter start). Use this module only with document classes that provide a chapter
 #environment.
 #DescriptionEnd
-#Requires: theorems-std | theorems-ams
+#Requires: theorems-std 
 #Excludes: theorems-sec
 
 # Author: Richard Kimberly Heck <rikiheck@lyx.org>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
@@ -20,11 +21,52 @@ End
 
 Style Theorem
 	Preamble
+		\def\lyx@reverse@two#1#2{#2#1}
+		\def\lyx@plain{plain}
+		\def\lyx@definition{definition}
+		\def\lyx@remark{remark}
+		\newcommand\theoremstyle[1]{%
+			\def\lyx@style{#1}%
+			\ifx\lyx@style\lyx@plain
+				\def\lyx@headfont{\bfseries}%
+				\def\lyx@bodyfont{\itshape}%
+			\else
+				\ifx\lyx@style\lyx@definition
+					\def\lyx@headfont{\bfseries}%
+					\def\lyx@bodyfont{\upshape}%
+				\else
+					\ifx\lyx@style\lyx@remark
+						\def\lyx@headfont{\itshape}%
+						\def\lyx@bodyfont{\upshape}%
+					\fi
+				\fi
+			\fi
+		}
+		\def\@xthm#1#2{%
+			\@begintheorem{\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}{\begingroup\upshape\csname the#1\endcsname\endgroup.}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\@ythm#1#2[#3]{%
+			\@opargbegintheorem{\normalfont{\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}}{\begingroup\csname lyx@\@firstoftwo#2@headfont\endcsname\upshape\csname the#1\endcsname\endgroup}{#3\lyx@reverse@two{\begingroup\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname.\endgroup}}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\lyx@othm#1[#2]#3{\@othm{#1}[#2]{{#1}{#3}}}
+		\def\lyx@nthm#1#2{\@ifnextchar[{\@xnthm{#1}{{#1}{#2}}}{\@ynthm{#1}{{#1}{#2}}}}
+		\renewcommand\newtheorem[1]{%
+			\expandafter\let\csname lyx@#1@headfont\expandafter\endcsname\lyx@headfont
+			\expandafter\let\csname lyx@#1@bodyfont\expandafter\endcsname\lyx@bodyfont
+			\@ifnextchar[{\lyx@othm{#1}}{\lyx@nthm{#1}}}
+		\newcommand\lyx@starred@newtheorem[2]{\newtheorem{#1}{#2}\expandafter\def\csname the#1\endcsname{\unskip}}
+		\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}[thm]{#2}}
+		\newcommand\lyx@newtheorem{\@ifstar{\lyx@starred@newtheorem}{\lyx@reg@newtheorem}}
 		\theoremstyle{plain}
-		\ifx\thechapter\undefined
-			\newtheorem{thm}{\protect\theoremname}
+		\ifcsname c@chapter\endcsname
+			\ifx\c@chapter\relax
+				\newtheorem{thm}{\protect\theoremname}
+			\else
+				\newtheorem{thm}{\protect\theoremname}[chapter]
+			\fi
 		\else
-			\newtheorem{thm}{\protect\theoremname}[chapter]
+			\newtheorem{thm}{\protect\theoremname}
 		\fi
 	EndPreamble
 End
+
diff --git a/lib/layouts/theorems-extended.inc b/lib/layouts/theorems-extended.inc
new file mode 100644
index 0000000000..ea15187653
--- /dev/null
+++ b/lib/layouts/theorems-extended.inc
@@ -0,0 +1,422 @@
+# theorem environments for the extended theorem modules
+
+Style Criterion
+	CopyStyle             Theorem
+	DependsOn	          Theorem
+	LatexName             criterion
+	LabelString           "Criterion \thetheorem."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{criterion}{\protect\criterionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\criterionname}{_(Criterion)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
+	EndBabelPreamble
+	DocBookAttr           role='criterion'
+	DocBookItemTag        ""
+End
+
+Style Criterion*
+	CopyStyle             Theorem*
+	LatexName             criterion*
+	LabelString           "Criterion."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{criterion*}{\protect\criterionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\criterionname}{_(Criterion)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\criterionname}{_(Criterion)}}
+	EndBabelPreamble
+	DocBookAttr           role='criterion'
+	DocBookItemTag        ""
+End
+
+
+Style Algorithm
+	CopyStyle             Theorem
+	DependsOn	           Theorem
+	LatexName             lyxalgorithm
+	LabelString           "Algorithm \thetheorem."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{lyxalgorithm}{\protect\algorithmname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\algorithmname}{_(Algorithm)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
+	EndBabelPreamble
+	DocBookAttr           role='algorithm'
+	DocBookItemTag                ""
+End
+
+
+Style Algorithm*
+	CopyStyle             Theorem*
+	LatexName             lyxalgorithm*
+	LabelString           "Algorithm."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{lyxalgorithm*}{\protect\algorithmname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\algorithmname}{_(Algorithm)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\algorithmname}{_(Algorithm)}}
+	EndBabelPreamble
+	DocBookAttr           role='algorithm'
+	DocBookItemTag              ""
+End
+
+
+Style Axiom
+	CopyStyle             Theorem
+	DependsOn	            Theorem
+	LatexName             ax
+	LabelString           "Axiom \thetheorem."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{ax}{\protect\axiomname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\axiomname}{_(Axiom)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
+	EndBabelPreamble
+	DocBookAttr           role='axiom'
+	DocBookItemTag        ""
+End
+
+
+Style Axiom*
+	CopyStyle             Theorem*
+	LatexName             ax*
+	LabelString           "Axiom."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{ax*}{\protect\axiomname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\axiomname}{_(Axiom)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\axiomname}{_(Axiom)}}
+	EndBabelPreamble
+	DocBookAttr           role='axiom'
+	DocBookItemTag        ""
+End
+
+
+Style Condition
+	CopyStyle             Definition
+	LatexName             condition
+	LabelString           "Condition \thetheorem."
+	Preamble
+	  \theoremstyle{definition}
+	  \lyx@newtheorem{condition}{\protect\conditionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\conditionname}{_(Condition)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
+	EndBabelPreamble
+	DocBookAttr           role='condition'
+	DocBookItemTag        ""
+End
+
+
+Style Condition*
+	CopyStyle             Definition*
+	LatexName             condition*
+	LabelString           "Condition."
+	Preamble
+	  \theoremstyle{definition}
+	  \lyx@newtheorem*{condition*}{\protect\conditionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\conditionname}{_(Condition)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\conditionname}{_(Condition)}}
+	EndBabelPreamble
+	DocBookAttr           role='condition'
+	DocBookItemTag        ""
+End
+
+
+Style Note
+	CopyStyle             Remark
+	LatexName             note
+	LabelString           "Note \thetheorem."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{note}{\protect\notename}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\notename}{_(Note)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
+	EndBabelPreamble
+	DocBookItemTag        para
+	DocBookTag            note
+End
+
+
+Style Note*
+	CopyStyle             Remark*
+	LatexName             note*
+	LabelString           "Note."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{note*}{\protect\notename}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\notename}{_(Note)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\notename}{_(Note)}}
+	EndBabelPreamble
+	DocBookItemTag        para
+	DocBookTag            note
+End
+
+
+Style Notation
+	CopyStyle             Remark
+	LatexName             notation
+	LabelString           "Notation \thetheorem."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{notation}{\protect\notationname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\notationname}{_(Notation)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
+	EndBabelPreamble
+	DocBookAttr           role='notation'
+	DocBookItemTag        ""
+End
+
+
+Style Notation*
+	CopyStyle             Remark*
+	LatexName             notation*
+	LabelString           "Notation."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{notation*}{\protect\notationname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\notationname}{_(Notation)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\notationname}{_(Notation)}}
+	EndBabelPreamble
+	DocBookAttr           role='notation'
+	DocBookItemTag        ""
+End
+
+
+Style Summary
+	CopyStyle             Remark
+	LatexName             summary
+	LabelString           "Summary \thetheorem."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{summary}{\protect\summaryname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\summaryname}{_(Summary)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
+	EndBabelPreamble
+	DocBookAttr           role='summary'
+	DocBookItemTag        ""
+End
+
+
+Style Summary*
+	CopyStyle             Remark*
+	LatexName             summary*
+	LabelString           "Summary."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{summary*}{\protect\summaryname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\summaryname}{_(Summary)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\summaryname}{_(Summary)}}
+	EndBabelPreamble
+	DocBookAttr           role='summary'
+	DocBookItemTag        ""
+End
+
+
+Style Acknowledgement
+	CopyStyle             Remark
+	LatexName             acknowledgement
+	LabelString           "Acknowledgement \thetheorem."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{acknowledgement}{\protect\acknowledgementname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
+	EndBabelPreamble
+	DocBookAttr           role='acknowledgement'
+	DocBookItemTag       ""
+End
+
+
+Style Acknowledgement*
+	CopyStyle             Remark*
+	LatexName             acknowledgement*
+	LabelString           "Acknowledgement."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{acknowledgement*}{\protect\acknowledgementname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\acknowledgementname}{_(Acknowledgement)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\acknowledgementname}{_(Acknowledgement)}}
+	EndBabelPreamble
+	DocBookAttr           role='acknowledgement'
+	DocBookItemTag       ""
+End
+
+
+Style Conclusion
+	CopyStyle             Remark
+	LatexName             conclusion
+	LabelString           "Conclusion \thetheorem."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{conclusion}{\protect\conclusionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\conclusionname}{_(Conclusion)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
+	EndBabelPreamble
+	DocBookAttr           role='conclusion'
+	DocBookItemTag        ""
+End
+
+
+Style Conclusion*
+	CopyStyle             Remark*
+	LatexName             conclusion*
+	LabelString           "Conclusion."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{conclusion*}{\protect\conclusionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\conclusionname}{_(Conclusion)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\conclusionname}{_(Conclusion)}}
+	EndBabelPreamble
+	DocBookAttr           role='conclusion'
+	DocBookItemTag        ""
+End
+
+
+Style Assumption
+	CopyStyle             Theorem
+	DependsOn	          Theorem
+	LatexName             assumption
+	LabelString           "Assumption \thetheorem."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{assumption}{\protect\assumptionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\assumptionname}{_(Assumption)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
+	EndBabelPreamble
+	DocBookAttr           role='assumption'
+	DocBookItemTag        ""
+End
+
+
+Style Assumption*
+	CopyStyle             Theorem*
+	LatexName             assumption*
+	LabelString           "Assumption."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{assumption*}{\protect\assumptionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\assumptionname}{_(Assumption)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\assumptionname}{_(Assumption)}}
+	EndBabelPreamble
+	DocBookAttr           role='assumption'
+	DocBookItemTag        ""
+End
+
+Style Question
+	CopyStyle             Theorem
+	DependsOn             Theorem
+	LatexName             question
+	LabelString           "Question \thetheorem."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{question}{\protect\questionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\questionname}{_(Question)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
+	EndBabelPreamble
+	DocBookAttr           role='question'
+	DocBookItemTag        ""
+End
+
+Style Question*
+	CopyStyle             Theorem*
+	LatexName             question*
+	LabelString           "Question."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{question*}{\protect\questionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\questionname}{_(Question)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\questionname}{_(Question)}}
+	EndBabelPreamble
+	DocBookAttr           role='question'
+	DocBookItemTag        ""
+End
+
+Input theorems-refprefix.inc
\ No newline at end of file
diff --git a/lib/layouts/theorems-labels.inc b/lib/layouts/theorems-labels.inc
new file mode 100644
index 0000000000..45dde6335d
--- /dev/null
+++ b/lib/layouts/theorems-labels.inc
@@ -0,0 +1,136 @@
+# Independent label counters for "Numbered By Type" theorem modules
+
+ModifyStyle Corollary
+	LabelString           "Corollary \thecorollary."
+	LabelCounter          corollary
+End
+
+
+ModifyStyle Lemma
+	LabelString           "Lemma \thelemma."
+	LabelCounter          lemma
+End
+
+
+ModifyStyle Proposition
+	LabelString           "Proposition \theproposition."
+	LabelCounter          proposition
+End
+
+
+ModifyStyle Conjecture
+	LabelString           "Conjecture \theconjecture."
+	LabelCounter          conjecture
+End
+
+
+ModifyStyle Fact
+	LabelString           "Fact \thefact."
+	LabelCounter          fact
+End
+
+
+ModifyStyle Definition
+	LabelString           "Definition \thedefinition."
+	LabelCounter          definition  
+End
+
+
+ModifyStyle Example
+	LabelString           "Example \theexample."
+	LabelCounter          example
+End
+
+
+ModifyStyle Problem
+	LabelString           "Problem \theproblem."
+	LabelCounter          problem
+End
+
+
+ModifyStyle Exercise
+	LabelString           "Exercise \theexercise."
+	LabelCounter          exercise
+End
+
+
+ModifyStyle Solution
+	LabelString           "Solution \thesolution."
+	LabelCounter          solution
+End
+
+
+ModifyStyle Remark
+	LabelString           "Remark \theremark."
+	LabelCounter          remark
+End
+
+
+ModifyStyle Claim
+	LabelString           "Claim \theclaim."
+	LabelCounter          claim
+End
+
+ModifyStyle Criterion
+	LabelString           "Criterion \thecriterion."
+	LabelCounter          criterion
+End
+
+ModifyStyle Algorithm
+	LabelString           "Algorithm \thealgorithm."
+	LabelCounter          algorithm
+End
+
+
+ModifyStyle Axiom
+	LabelString           "Axiom \theaxiom."
+	LabelCounter          axiom
+End
+
+
+ModifyStyle Condition
+	LabelString           "Condition \thecondition."
+	LabelCounter          condition
+End
+
+
+ModifyStyle Note
+	LabelString           "Note \thenote."
+	LabelCounter          note
+End
+
+
+ModifyStyle Notation
+	LabelString           "Notation \thenotation."
+	LabelCounter          notation
+End
+
+
+ModifyStyle Summary
+	LabelString           "Summary \thesummary."
+	LabelCounter          summary
+End
+
+
+ModifyStyle Acknowledgement
+	LabelString           "Acknowledgement \theacknowledgement."
+	LabelCounter          acknowledgement
+End
+
+
+ModifyStyle Conclusion
+	LabelString           "Conclusion \theconclusion."
+	LabelCounter          conclusion
+End
+
+
+ModifyStyle Assumption
+	LabelString           "Assumption \theassumption."
+	LabelCounter          assumption
+End
+
+
+ModifyStyle Question
+	LabelString           "Question \thequestion."
+	LabelCounter          question
+End
\ No newline at end of file
diff --git a/lib/layouts/theorems-named.module b/lib/layouts/theorems-named.module
index 556515036f..01f4f6470c 100644
--- a/lib/layouts/theorems-named.module
+++ b/lib/layouts/theorems-named.module
@@ -6,23 +6,30 @@
 # goes into the 'Additional Theorem Text' argument.
 #DescriptionEnd
 #Original Author: John Perry
+#Edited by Udi Fogiel
 
 Format 95
 
-ProvideStyle Theorem*
-	Category              Reasoning
-	LatexType             Environment
+OutlinerName thm "Definitions & Theorems"
+
+Style "Named Theorem"
+	CopyStyle Theorem*
+	Category Reasoning
 	Margin                First_Dynamic
-	LatexName             thm*
 	LabelType             Static
-	LabelString           "Theorem."
-	NextNoIndent          1
-	ResetArgs             1
+	AddToToc              thm
+	IsTocCaption          0
+	LatexType             Environment
+	LabelString ""
+	LatexName namedthm
+	AddToToc              thm
 	Argument 1
-		LabelString    "Additional Theorem Text"
-		Tooltip        "Additional text appended to the theorem header"
+		LabelString   "Theorem Title"
+		Tooltip       "Theorem Title"
+		AutoInsert	1
+		IsTocCaption          1
+		PassThru		1
 	EndArgument
-	LabelSep              xx
 	ParIndent             MMM
 	ParSkip               0.4
 	ItemSep               0.2
@@ -32,43 +39,31 @@ ProvideStyle Theorem*
 	Align                 Block
 	AlignPossible         Left
 	Font
-	  Shape               Italic
-	  Size                Normal
+		Shape               Italic
+		Size                Normal
 	EndFont
 	LabelFont
-	  Shape               Up
-	  Series              Bold
+		Shape               Up
+		Series              Bold
 	EndFont
 	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{thm*}{\protect\theoremname}
+		\newcommand\thmsname\namedthmname
+		\newtheorem*{namedtheorem}{\protect\thmsname}
+		\newenvironment{namedthm}[1][]{%
+			\if\relax\detokenize{#1}\relax
+				\begin{namedtheorem}
+			\else
+				\renewcommand\thmsname{#1}%
+				\begin{namedtheorem}%
+			\fi
+			}{\end{namedtheorem}}
 	EndPreamble
 	LangPreamble
-	  \providecommand{\theoremname}{_(Theorem)}
+		\providecommand\namedthmname{_(Theorem)}
 	EndLangPreamble
 	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
+	  \addto\captions$$lang{\renewcommand{\namedthmname}{_(Theorem)}}
 	EndBabelPreamble
 	Requires              amsthm
 End
 
-
-Style "Named Theorem"
-  CopyStyle Theorem*
-  Category Reasoning
-  LabelString "Named Theorem."
-  LatexName namedthm
-  Preamble
-    \newcommand\thmsname{\protect\theoremname}
-    \newcommand\nm@thmtype{theorem}
-    \theoremstyle{plain}
-    \newtheorem*{namedtheorem}{\thmsname}
-    \newenvironment{namedthm}[1][Undefined Theorem Name]{
-      \ifx{#1}{Undefined Theorem Name}\renewcommand\nm@thmtype{theorem*}
-      \else\renewcommand\thmsname{#1}\renewcommand\nm@thmtype{namedtheorem}
-      \fi
-      \begin{\nm@thmtype}}
-      {\end{\nm@thmtype}}
-  EndPreamble
-End
-
diff --git a/lib/layouts/theorems-order.inc b/lib/layouts/theorems-order.inc
deleted file mode 100644
index 584bd6d2ea..0000000000
--- a/lib/layouts/theorems-order.inc
+++ /dev/null
@@ -1,83 +0,0 @@
-# Sets the order of the main theorem environments
-# Author: Richard Kimberly Heck
-
-Format 95
-
-#Get the order right
-Style Theorem
-End
-
-Style Theorem*
-End
-
-Style Corollary
-End
-
-Style Corollary*
-End
-
-Style Lemma
-End
-
-Style Lemma*
-End
-
-Style Proposition
-End
-
-Style Proposition*
-End
-
-Style Conjecture
-End
-
-Style Conjecture*
-End
-
-Style Definition
-End
-
-Style Definition*
-End
-
-Style Example
-End
-
-Style Example*
-End
-
-Style Problem
-End
-
-Style Problem*
-End
-
-Style Exercise
-End
-
-Style Exercise*
-End
-
-Style Solution
-End
-
-Style Solution*
-End
-
-Style Remark
-End
-
-Style Remark*
-End
-
-Style Claim
-End
-
-Style Claim*
-End
-
-Style Case
-End
-
-Style Proof
-End
diff --git a/lib/layouts/theorems-proof-std.inc b/lib/layouts/theorems-proof-std.inc
index 7e343902f4..290344d218 100644
--- a/lib/layouts/theorems-proof-std.inc
+++ b/lib/layouts/theorems-proof-std.inc
@@ -1,24 +1,62 @@
-# Moved here by rikiheck. Original author cloudy.
+# Moved here by rgheck. Original author cloudy.
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com> (more similar version to the amsthm one)
+
 
 Format 95
 
 #This is just a hacked version of the AMS proof environment
 Style Proof
+	Category              Reasoning
+	Margin                First_Dynamic
+	LatexType             Environment
+	LatexName             proof
+	NextNoIndent          1
+	ResetArgs             1
+	Argument 1
+		LabelString   "Alternative Proof String"
+		Tooltip       "Alternative proof string"
+	EndArgument
+	LabelSep              xx
+	ParIndent             MMM
+	ParSkip               0.4
+	ItemSep               0.2
+	TopSep                0.7
+	BottomSep             0.7
+	ParSep                0.3
+	Align                 Block
+	AlignPossible         Block, Left
+	LabelType             Static
+	LabelString           "Proof."
+	EndLabelType          Box
+	Font
+	  Shape               Up
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Shape               Italic
+	EndFont
 	Preamble
-		\ifx\proof\undefined
-		\newenvironment{proof}[1][\protect\proofname]{\par
-			\normalfont\topsep6\p@\@plus6\p@\relax
-			\trivlist
-			\itemindent\parindent
-			\item[\hskip\labelsep\scshape #1]\ignorespaces
-		}{%
-			\endtrivlist\@endpefalse
-		}
-		\providecommand{\proofname}{Proof}
+		\ifcsname proof\endcsname\else
+			\DeclareRobustCommand{\lyx@qed}{%
+			  \ifmmode
+			  \else \leavevmode\unskip\penalty9999 \hbox{}\nobreak\hfill
+			  \fi
+			  \quad\hbox{\lyx@qedsymbol}}
+			\newcommand{\lyx@openbox}{\leavevmode
+			  \hbox to.77778em{%
+			  \hfil\vrule
+			  \vbox to.675em{\hrule width.6em\vfil\hrule}%
+			  \vrule\hfil}}
+			\newcommand{\lyx@qedsymbol}{\lyx@openbox}
+			\newenvironment{proof}[1][\proofname]{\par
+			  \normalfont
+			  \topsep6\p@\@plus6\p@ \trivlist
+			  \item[\hskip\labelsep\itshape
+				#1.]\ignorespaces
+			}{%
+			  \lyx@qed\endtrivlist
+			}
 		\fi
 	EndPreamble
-	EndLabelType          No_Label
 # No LangPreamble or BabelPreamble, since babel knows \proofname already.
-	DocBookTag            para
-	DocBookAttr           role='proof'
-End
+End
\ No newline at end of file
diff --git a/lib/layouts/theorems-proof.inc b/lib/layouts/theorems-proof.inc
index 01707e9d6d..c5e37dc40a 100644
--- a/lib/layouts/theorems-proof.inc
+++ b/lib/layouts/theorems-proof.inc
@@ -42,5 +42,6 @@ Style Proof
 	EndFont
 	DocBookTag            para
 	DocBookAttr           role='proof'
+	Requires              amsthm
 End
 
diff --git a/lib/layouts/theorems-sec-bytype.module b/lib/layouts/theorems-sec-bytype.module
index 6efa866f05..bd4f248df8 100644
--- a/lib/layouts/theorems-sec-bytype.module
+++ b/lib/layouts/theorems-sec-bytype.module
@@ -7,15 +7,14 @@
 #as opposed to theorem 1, theorem 2, lemma 3, proposition 4, ...). The numbering is reset
 #at each section start.
 #DescriptionEnd
-#Requires: theorems-bytype | theorems-ams-bytype
-#Excludes: theorems-std | theorems-ams | theorems-starred | theorems-chap | theorems-chap-bytype
+#Requires: theorems-bytype
+#Excludes: theorems-chap-bytype
 
 # Author: Paul Rubin <rubin@msu.edu> (hacked from Richard Kimberly Heck's various modules)
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
-Input theorems-counters-bytype.inc
-
 Counter theorem
 	Within section
 End
@@ -55,95 +54,53 @@ End
 
 Style Theorem
 	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{thm}{\protect\theoremname}[section]
-	EndPreamble
-End
-
-
-Style Corollary
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{cor}{\protect\corollaryname}[section]
-	EndPreamble
-End
-
-
-Style Lemma
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{lem}{\protect\lemmaname}[section]
-	EndPreamble
-End
-
-
-Style Proposition
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{prop}{\protect\propositionname}[section]
-	EndPreamble
-End
-
-
-Style Conjecture
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{conjecture}{\protect\conjecturename}[section]
-	EndPreamble
-End
-
-
-Style Fact
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem{fact}{\protect\factname}[section]
-	EndPreamble
-End
-
-
-Style Definition
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{defn}{\protect\definitionname}[section]
-	EndPreamble
-End
-
-
-Style Example
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{example}{\protect\examplename}[section]
-	EndPreamble
-End
-
-
-Style Problem
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{problem}{\protect\problemname}[section]
-	EndPreamble
-End
-
-
-Style Exercise
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem{xca}{\protect\exercisename}[section]
-	EndPreamble
-End
-
-
-Style Remark
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{rem}{\protect\remarkname}[section]
-	EndPreamble
-End
-
-
-Style Claim
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem{claim}{\protect\claimname}[section]
+		\def\lyx@reverse@two#1#2{#2#1}
+		\def\lyx@plain{plain}
+		\def\lyx@definition{definition}
+		\def\lyx@remark{remark}
+		\newcommand\theoremstyle[1]{%
+			\def\lyx@style{#1}%
+			\ifx\lyx@style\lyx@plain
+				\def\lyx@headfont{\bfseries}%
+				\def\lyx@bodyfont{\itshape}%
+			\else
+				\ifx\lyx@style\lyx@definition
+					\def\lyx@headfont{\bfseries}%
+					\def\lyx@bodyfont{\upshape}%
+				\else
+					\ifx\lyx@style\lyx@remark
+						\def\lyx@headfont{\itshape}%
+						\def\lyx@bodyfont{\upshape}%
+					\fi
+				\fi
+			\fi
+		}
+		\def\@xthm#1#2{%
+			\@begintheorem{\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}{\begingroup\upshape\csname the#1\endcsname\endgroup.}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\@ythm#1#2[#3]{%
+			\@opargbegintheorem{\normalfont{\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}}{\begingroup\csname lyx@\@firstoftwo#2@headfont\endcsname\upshape\csname the#1\endcsname\endgroup}{#3\lyx@reverse@two{\begingroup\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname.\endgroup}}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\lyx@othm#1[#2]#3{\@othm{#1}[#2]{{#1}{#3}}}
+		\def\lyx@nthm#1#2{\@ifnextchar[{\@xnthm{#1}{{#1}{#2}}}{\@ynthm{#1}{{#1}{#2}}}}
+		\renewcommand\newtheorem[1]{%
+			\expandafter\let\csname lyx@#1@headfont\expandafter\endcsname\lyx@headfont
+			\expandafter\let\csname lyx@#1@bodyfont\expandafter\endcsname\lyx@bodyfont
+			\@ifnextchar[{\lyx@othm{#1}}{\lyx@nthm{#1}}}
+		\newcommand\lyx@starred@newtheorem[2]{\newtheorem{#1}{#2}\expandafter\def\csname the#1\endcsname{\unskip}}
+		\newcommand\lyx@newtheorem{\@ifstar{\lyx@starred@newtheorem}{\lyx@reg@newtheorem}}
+		\theoremstyle{plain}
+		\ifcsname c@section\endcsname
+			\ifx\c@section\relax
+				\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+				\newtheorem{thm}{\protect\theoremname}
+			\else
+				\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}[section]}
+				\newtheorem{thm}{\protect\theoremname}[section]
+			\fi
+		\else
+			\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}{#2}}
+			\newtheorem{thm}{\protect\theoremname}
+		\fi
 	EndPreamble
 End
diff --git a/lib/layouts/theorems-sec.module b/lib/layouts/theorems-sec.module
index e146346cb2..2c6a4b99d9 100644
--- a/lib/layouts/theorems-sec.module
+++ b/lib/layouts/theorems-sec.module
@@ -4,10 +4,11 @@
 #Numbers theorems and the like by section (i.e., the counter is reset at
 #each section start).
 #DescriptionEnd
-#Requires: theorems-std | theorems-ams
+#Requires: theorems-std
 #Excludes: theorems-chap
 
 # Author: Richard Kimberly Heck <rikiheck@lyx.org>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
@@ -19,7 +20,51 @@ End
 
 Style Theorem
 	Preamble
+		\def\lyx@reverse@two#1#2{#2#1}
+		\def\lyx@plain{plain}
+		\def\lyx@definition{definition}
+		\def\lyx@remark{remark}
+		\newcommand\theoremstyle[1]{%
+			\def\lyx@style{#1}%
+			\ifx\lyx@style\lyx@plain
+				\def\lyx@headfont{\bfseries}%
+				\def\lyx@bodyfont{\itshape}%
+			\else
+				\ifx\lyx@style\lyx@definition
+					\def\lyx@headfont{\bfseries}%
+					\def\lyx@bodyfont{\upshape}%
+				\else
+					\ifx\lyx@style\lyx@remark
+						\def\lyx@headfont{\itshape}%
+						\def\lyx@bodyfont{\upshape}%
+					\fi
+				\fi
+			\fi
+		}
+		\def\@xthm#1#2{%
+			\@begintheorem{\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}{\begingroup\upshape\csname the#1\endcsname\endgroup.}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\@ythm#1#2[#3]{%
+			\@opargbegintheorem{\normalfont{\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}}{\begingroup\csname lyx@\@firstoftwo#2@headfont\endcsname\upshape\csname the#1\endcsname\endgroup}{#3\lyx@reverse@two{\begingroup\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname.\endgroup}}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\lyx@othm#1[#2]#3{\@othm{#1}[#2]{{#1}{#3}}}
+		\def\lyx@nthm#1#2{\@ifnextchar[{\@xnthm{#1}{{#1}{#2}}}{\@ynthm{#1}{{#1}{#2}}}}
+		\renewcommand\newtheorem[1]{%
+			\expandafter\let\csname lyx@#1@headfont\expandafter\endcsname\lyx@headfont
+			\expandafter\let\csname lyx@#1@bodyfont\expandafter\endcsname\lyx@bodyfont
+			\@ifnextchar[{\lyx@othm{#1}}{\lyx@nthm{#1}}}
+		\newcommand\lyx@starred@newtheorem[2]{\newtheorem{#1}{#2}\expandafter\def\csname the#1\endcsname{\unskip}}
+		\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}[thm]{#2}}
+		\newcommand\lyx@newtheorem{\@ifstar{\lyx@starred@newtheorem}{\lyx@reg@newtheorem}}
 		\theoremstyle{plain}
-		\newtheorem{thm}{\protect\theoremname}[section]
+		\ifcsname c@section\endcsname
+			\ifx\c@section\relax
+				\newtheorem{thm}{\protect\theoremname}
+			\else
+				\newtheorem{thm}{\protect\theoremname}[section]
+			\fi
+		\else
+			\newtheorem{thm}{\protect\theoremname}
+		\fi
 	EndPreamble
 End
diff --git a/lib/layouts/theorems-starred-equivalents.inc b/lib/layouts/theorems-starred-equivalents.inc
deleted file mode 100644
index 752f4bcb86..0000000000
--- a/lib/layouts/theorems-starred-equivalents.inc
+++ /dev/null
@@ -1,88 +0,0 @@
-# Sets the order of the main theorem environments
-# Author: Richard Kimberly Heck
-
-Format 95
-
-Style Theorem
-	CopyStyle	Theorem*
-	DependsOn	Theorem*
-	Preamble
-	EndPreamble
-End
-
-Style Corollary
-	CopyStyle	Corollary*
-	DependsOn	Corollary*
-	Preamble
-	EndPreamble
-End
-
-Style Lemma
-	CopyStyle	Lemma*
-	DependsOn	Lemma*
-	Preamble
-	EndPreamble
-End
-
-Style Proposition
-	CopyStyle	Proposition*
-	DependsOn	Proposition*
-	Preamble
-	EndPreamble
-End
-
-Style Conjecture
-	CopyStyle	Conjecture*
-	DependsOn	Conjecture*
-	Preamble
-	EndPreamble
-End
-
-Style Definition
-	CopyStyle	Definition*
-	DependsOn	Definition*
-	Preamble
-	EndPreamble
-End
-
-Style Example
-	CopyStyle	Example*
-	DependsOn	Example*
-	Preamble
-	EndPreamble
-End
-
-Style Solution
-	CopyStyle	Solution*
-	DependsOn	Solution*
-	Preamble
-	EndPreamble
-End
-
-Style Problem
-	CopyStyle	Problem*
-	DependsOn	Problem*
-	Preamble
-	EndPreamble
-End
-
-Style Exercise
-	CopyStyle	Exercise*
-	DependsOn	Exercise*
-	Preamble
-	EndPreamble
-End
-
-Style Remark
-	CopyStyle	Remark*
-	DependsOn	Remark*
-	Preamble
-	EndPreamble
-End
-
-Style Claim
-	CopyStyle	Claim*
-	DependsOn	Claim*
-	Preamble
-	EndPreamble
-End
diff --git a/lib/layouts/theorems-starred.inc b/lib/layouts/theorems-starred.inc
deleted file mode 100644
index e7a095d5ad..0000000000
--- a/lib/layouts/theorems-starred.inc
+++ /dev/null
@@ -1,319 +0,0 @@
-# Original Author : David L. Johnson <dlj0@lehigh.edu>
-# Probably broken by Jean-Marc Lasgouttes <Jean-Marc.Lasgouttes@inria.fr>
-# modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
-# Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
-# Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
-
-# The starred environnements defined are :
-# - Theorem
-# - Corollary
-# - Lemma
-# - Proposition
-# - Conjecture
-# - Definition
-# - Example
-# - Problem
-# - Exercise
-# - Solution
-# - Remark
-# - Claim
-# - Proof
-
-Format 95
-
-OutlinerName thm "Definitions & Theorems"
-
-Style Theorem*
-	Category              Reasoning
-	LatexType             Environment
-	Margin                First_Dynamic
-	LatexName             thm*
-	LabelType             Static
-	LabelString           "Theorem."
-	NextNoIndent          1
-	ResetArgs             1
-	AddToToc              thm
-	IsTocCaption          1
-	Argument 1
-		LabelString    "Additional Theorem Text"
-		Tooltip        "Additional text appended to the theorem header"
-		IsTocCaption      1
-	EndArgument
-	LabelSep              xx
-	ParIndent             MMM
-	ParSkip               0.4
-	ItemSep               0.2
-	TopSep                0.7
-	BottomSep             0.7
-	ParSep                0.3
-	Align                 Block
-	AlignPossible         Left
-	Font
-	  Shape               Italic
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{thm*}{\protect\theoremname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\theoremname}{_(Theorem)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
-	EndBabelPreamble
-	Requires              amsthm
-	DocBookTag            para
-	DocBookAttr           role='theorem'
-End
-
-
-Style Corollary*
-	CopyStyle             Theorem*
-	LatexName             cor*
-	LabelString           "Corollary."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{cor*}{\protect\corollaryname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\corollaryname}{_(Corollary)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='corollary'
-End
-
-
-Style Lemma*
-	CopyStyle             Theorem*
-	LatexName             lem*
-	LabelString           "Lemma."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{lem*}{\protect\lemmaname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\lemmaname}{_(Lemma)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='lemma'
-End
-
-
-Style Proposition*
-	CopyStyle             Theorem*
-	LatexName             prop*
-	LabelString           "Proposition."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{prop*}{\protect\propositionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\propositionname}{_(Proposition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='proposition'
-End
-
-
-Style Conjecture*
-	CopyStyle             Theorem*
-	LatexName             conjecture*
-	LabelString           "Conjecture."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{conjecture*}{\protect\conjecturename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\conjecturename}{_(Conjecture)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='conjecture'
-End
-
-
-Style Fact*
-	CopyStyle             Theorem*
-	LatexName             fact*
-	LabelString           "Fact."
-	Preamble
-	  \theoremstyle{plain}
-	  \newtheorem*{fact*}{\protect\factname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\factname}{_(Fact)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='fact'
-End
-
-
-Style Definition*
-	CopyStyle             Theorem*
-	LatexName             defn*
-#LabelType             Static
-	LabelString           "Definition."
-	Font
-	  Shape               Up
-	EndFont
-	LabelFont
-	  Shape               Up
-	  Series              Bold
-	EndFont
-	Preamble
-	 \theoremstyle{definition}
-	 \newtheorem*{defn*}{\protect\definitionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\definitionname}{_(Definition)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='definition'
-End
-
-
-Style Example*
-	CopyStyle             Definition*
-	LatexName             example*
-	LabelString           "Example."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{example*}{\protect\examplename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\examplename}{_(Example)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
-	EndBabelPreamble
-	DocBookWrapperTag     informalexample
-	DocBookTag            para
-	DocBookAttr        ""
-End
-
-
-Style Problem*
-	CopyStyle             Definition*
-	LatexName             problem*
-	LabelString           "Problem."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{problem*}{\protect\problemname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\problemname}{_(Problem)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='problem'
-End
-
-
-Style Exercise*
-	CopyStyle             Definition*
-	LatexName             xca*
-	LabelString           "Exercise."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{xca*}{\protect\exercisename}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\exercisename}{_(Exercise)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='exercise'
-End
-
-
-Style Solution*
-	CopyStyle             Definition*
-	LatexName             sol*
-	LabelString           "Solution."
-	Preamble
-	  \theoremstyle{definition}
-	  \newtheorem*{sol*}{\protect\solutionname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\solutionname}{_(Solution)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='solution'
-End
-
-
-Style Remark*
-	CopyStyle             Theorem*
-	LatexName             rem*
-	LabelString           "Remark."
-	Font
-	  Shape               Up
-	  Size                Normal
-	EndFont
-	LabelFont
-	  Series              Medium
-	  Shape               Italic
-	EndFont
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{rem*}{\protect\remarkname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\remarkname}{_(Remark)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
-	EndBabelPreamble
-	DocBookTag            note
-	DocBookItemTag        para
-End
-
-
-Style Claim*
-	CopyStyle             Remark*
-	LatexName             claim*
-	LabelString           "Claim."
-	Preamble
-	  \theoremstyle{remark}
-	  \newtheorem*{claim*}{\protect\claimname}
-	EndPreamble
-	LangPreamble
-	  \providecommand{\claimname}{_(Claim)}
-	EndLangPreamble
-	BabelPreamble
-	  \addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
-	EndBabelPreamble
-	DocBookTag            para
-	DocBookAttr           role='claim'
-	DocBookItemTag        ""
-End
-
diff --git a/lib/layouts/theorems-starred.module b/lib/layouts/theorems-starred.module
deleted file mode 100644
index 4cb450c21b..0000000000
--- a/lib/layouts/theorems-starred.module
+++ /dev/null
@@ -1,16 +0,0 @@
-#\DeclareLyXModule{Standard Theorems (Unnumbered)}
-#\DeclareCategory{Maths}
-#DescriptionBegin
-#Defines only unnumbered theorem environments, and the proof environment, using 
-#the extended AMS machinery. 
-#DescriptionEnd
-#Excludes: theorems-std | theorems-ams
-
-# Author: Richard Kimberly Heck <rikiheck@lyx.org>
-
-Format 95
-
-Input theorems-order.inc
-Input theorems-starred.inc
-Input theorems-starred-equivalents.inc
-Input theorems-proof.inc
diff --git a/lib/layouts/theorems-std.module b/lib/layouts/theorems-std.module
index ecf9fc7f91..ee5894b738 100644
--- a/lib/layouts/theorems-std.module
+++ b/lib/layouts/theorems-std.module
@@ -5,9 +5,10 @@
 #the theorems are numbered consecutively throughout the document. This can be
 #changed by loading one of the 'Theorems (Numbered by ...)' modules.
 #DescriptionEnd
-#Excludes: theorems-ams | theorems-starred
+#Excludes: theorems-ams | theorems-ams-bytype | theorems-bytype
 
 # Author: Richard Kimberly Heck <rikiheck@lyx.org>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 Format 95
 
@@ -17,5 +18,47 @@ Counter theorem
 End
 
 Input theorems.inc
-Input theorems-proof.inc
 Input theorems-proof-std.inc
+
+Style Theorem
+	Preamble
+		\def\lyx@reverse@two#1#2{#2#1}
+		\def\lyx@plain{plain}
+		\def\lyx@definition{definition}
+		\def\lyx@remark{remark}
+		\newcommand\theoremstyle[1]{%
+			\def\lyx@style{#1}%
+			\ifx\lyx@style\lyx@plain
+				\def\lyx@headfont{\bfseries}%
+				\def\lyx@bodyfont{\itshape}%
+			\else
+				\ifx\lyx@style\lyx@definition
+					\def\lyx@headfont{\bfseries}%
+					\def\lyx@bodyfont{\upshape}%
+				\else
+					\ifx\lyx@style\lyx@remark
+						\def\lyx@headfont{\itshape}%
+						\def\lyx@bodyfont{\upshape}%
+					\fi
+				\fi
+			\fi
+		}
+		\def\@xthm#1#2{%
+			\@begintheorem{\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}{\begingroup\upshape\csname the#1\endcsname\endgroup.}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\@ythm#1#2[#3]{%
+			\@opargbegintheorem{\normalfont{\csname lyx@\@firstoftwo#2@headfont\endcsname \@secondoftwo#2}}{\begingroup\csname lyx@\@firstoftwo#2@headfont\endcsname\upshape\csname the#1\endcsname\endgroup}{#3\lyx@reverse@two{\begingroup\normalfont\csname lyx@\@firstoftwo#2@headfont\endcsname.\endgroup}}\normalfont\csname lyx@\@firstoftwo#2@bodyfont\endcsname\ignorespaces
+		}
+		\def\lyx@othm#1[#2]#3{\@othm{#1}[#2]{{#1}{#3}}}
+		\def\lyx@nthm#1#2{\@ifnextchar[{\@xnthm{#1}{{#1}{#2}}}{\@ynthm{#1}{{#1}{#2}}}}
+		\renewcommand\newtheorem[1]{%
+			\expandafter\let\csname lyx@#1@headfont\expandafter\endcsname\lyx@headfont
+			\expandafter\let\csname lyx@#1@bodyfont\expandafter\endcsname\lyx@bodyfont
+			\@ifnextchar[{\lyx@othm{#1}}{\lyx@nthm{#1}}}
+		\newcommand\lyx@starred@newtheorem[2]{\newtheorem{#1}{#2}\expandafter\def\csname the#1\endcsname{\unskip}}
+		\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}[thm]{#2}}
+		\newcommand\lyx@newtheorem{\@ifstar{\lyx@starred@newtheorem}{\lyx@reg@newtheorem}}
+		\theoremstyle{plain}
+		\newtheorem{thm}{\protect\theoremname}
+	EndPreamble
+End
diff --git a/lib/layouts/theorems-thmtools.module b/lib/layouts/theorems-thmtools.module
new file mode 100644
index 0000000000..a6d9b29df7
--- /dev/null
+++ b/lib/layouts/theorems-thmtools.module
@@ -0,0 +1,783 @@
+#\DeclareLyXModule{Theorems (thmtools, Numbered by Type)}
+#\DeclareCategory{Maths}
+#DescriptionBegin
+#Defines the theorem environments defined in the AMS-Theorem modules using the
+#thmtools machinery. Both numbered and unnumbered types are provided. In Addition,
+#one can use the \listoftheorems command provided by the thmtools.sty package.
+#DescriptionEnd
+#Excludes: theorems-std | theorems-ams | theorems-bytype | theorems-ams-bytype
+
+# Original Author : Udi Fogiel
+
+
+Format 95
+
+# The environments defined are:
+# - Theorem
+# - Corollary
+# - Lemma
+# - Proposition
+# - Conjecture
+# - Fact
+# - Definition
+# - Example
+# - Problem
+# - Exercise
+# - Solution
+# - Remark
+# - Claim
+# - Theorem*
+# - Corollary*
+# - Lemma*
+# - Proposition*
+# - Conjecture*
+# - Fact*
+# - Definition*
+# - Example*
+# - Problem*
+# - Exercise*
+# - Solution*
+# - Remark*
+# - Claim*
+
+# We need separate counters for each theorem-like style.
+
+Counter theorem
+	Within         section
+End
+Counter corollary
+	Within         section
+End
+Counter lemma
+	Within         section
+End
+Counter proposition
+	Within         section
+End
+Counter conjecture
+	Within         section
+End
+Counter fact
+	Within         section
+End
+Counter definition
+	Within         section
+End
+Counter example
+	Within         section
+End
+Counter problem
+	Within         section
+End
+Counter exercise
+	Within         section
+End
+Counter remark
+	Within         section
+End
+Counter claim
+	Within         section
+End
+
+OutlinerName thm "Definitions & Theorems"
+
+Style Theorem
+	Category              Reasoning
+	Margin                First_Dynamic
+	LatexType             Environment
+	LatexName             thm
+	NextNoIndent          1
+	ResetArgs             1
+	AddToToc              thm
+	IsTocCaption          1
+	Argument 1
+		LabelString    "Theorem Name"
+		Tooltip        "Additional text appended to the theorem header"
+		IsTocCaption      1
+	EndArgument
+	LabelSep              xx
+	ParIndent             MMM
+	ParSkip               0.4
+	ItemSep               0.2
+	TopSep                0.7
+	BottomSep             0.7
+	ParSep                0.3
+	Align                 Block
+	AlignPossible         Left
+	LabelType             Static
+	LabelCounter          theorem
+	LabelString           "Theorem \thetheorem."
+	Font
+	  Shape               Italic
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Shape               Up
+	  Series              Bold
+	EndFont
+	Preamble
+		\usepackage{thmtools}
+		\renewcommand{\thmt@mklistcmd}{%
+			\ifcsname lyx\csname thmt@envname\endcsname name\endcsname
+				\thmtlo@newentry
+				\ifthmt@isstarred
+					\@xa\def\csname ll@\thmt@envname\endcsname{%
+						\protect\ifthmt@listswap
+						\protect\else
+						\protect\numberline{\protect\let\protect\autodot\protect\@empty}%
+						\protect\fi
+						\csname lyx\csname thmt@envname\endcsname name\endcsname
+						\ifx\@empty\thmt@shortoptarg\else\protect\thmtformatoptarg{\thmt@shortoptarg}\fi
+					}%
+				\else
+					\@xa\def\csname ll@\thmt@envname\endcsname{%
+						\protect\ifthmt@listswap
+						\csname lyx\csname thmt@envname\endcsname name\endcsname~\csname the\thmt@envname\endcsname
+						\protect\else
+						\protect\numberline{\csname the\thmt@envname\endcsname}%
+						\csname lyx\csname thmt@envname\endcsname name\endcsname
+						\protect\fi
+						\ifx\@empty\thmt@shortoptarg\else\protect\thmtformatoptarg{\thmt@shortoptarg}\fi
+					}%
+				\fi
+				\@xa\gdef\csname thmt@contentsline@\thmt@envname\endcsname{%
+					\thmt@contentslineShow
+				}%
+			\else
+				\thmtlo@newentry
+				\ifthmt@isstarred
+					\@xa\def\csname ll@\thmt@envname\endcsname{%
+						\protect\ifthmt@listswap
+						\protect\else
+						\protect\numberline{\protect\let\protect\autodot\protect\@empty}%
+						\protect\fi
+						\thmt@thmname
+						\ifx\@empty\thmt@shortoptarg\else\protect\thmtformatoptarg{\thmt@shortoptarg}\fi
+					}%
+				\else
+					\@xa\def\csname ll@\thmt@envname\endcsname{%
+						\protect\ifthmt@listswap
+						\thmt@thmname~\csname the\thmt@envname\endcsname
+						\protect\else
+						\protect\numberline{\csname the\thmt@envname\endcsname}%
+						\thmt@thmname
+						\protect\fi
+						\ifx\@empty\thmt@shortoptarg\else\protect\thmtformatoptarg{\thmt@shortoptarg}\fi
+					}%
+				\fi
+				\@xa\gdef\csname thmt@contentsline@\thmt@envname\endcsname{%
+					\thmt@contentslineShow
+				}%
+			\fi
+		}
+		\expandafter\providecommand\csname lyxthmname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxthmname\endcsname]{thm}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxthmname\endcsname{_(Theorem)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxthmname\endcsname{_(Theorem)}}
+	EndBabelPreamble
+	Requires              amsthm
+	DocBookTag            para
+	DocBookAttr           role='theorem'
+End
+
+
+Style Theorem*
+	Category              Reasoning
+	LatexType             Environment
+	Margin                First_Dynamic
+	LatexName             thm*
+	LabelType             Static
+	LabelString           "Theorem."
+	NextNoIndent          1
+	ResetArgs             1
+	AddToToc              thm
+	IsTocCaption          1
+	Argument 1
+		LabelString    "Theorem Name"
+		Tooltip        "Additional text appended to the theorem header"
+		IsTocCaption      1
+	EndArgument
+	LabelSep              xx
+	ParIndent             MMM
+	ParSkip               0.4
+	ItemSep               0.2
+	TopSep                0.7
+	BottomSep             0.7
+	ParSep                0.3
+	Align                 Block
+	AlignPossible         Left
+	Font
+	  Shape               Italic
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Shape               Up
+	  Series              Bold
+	EndFont
+	Preamble
+		\expandafter\providecommand\csname lyxthm*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxthm*name\endcsname]{thm*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxthm*name\endcsname{_(Theorem)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxthm*name\endcsname{_(Theorem)}}
+	EndBabelPreamble
+	Requires              amsthm
+	DependsOn		Theorem
+	DocBookTag            para
+	DocBookAttr           role='theorem'
+End
+
+
+Style Corollary
+	CopyStyle             Theorem
+	LatexName             cor
+	LabelString           "Corollary \thecorollary."
+	Preamble
+		\expandafter\providecommand\csname lyxcorname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxcorname\endcsname]{cor}
+	EndPreamble
+	LabelCounter          corollary
+	LangPreamble
+		\expandafter\renewcommand\csname lyxcorname\endcsname{_(Corollary)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxcorname\endcsname{_(Corollary)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='corollary'
+End
+
+
+Style Corollary*
+	CopyStyle             Theorem*
+	LatexName             cor*
+	LabelString           "Corollary."
+	Preamble
+		\expandafter\providecommand\csname lyxcor*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxcorname\endcsname]{cor*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxcor*name\endcsname{_(Corollary)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxcor*name\endcsname{_(Corollary)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='corollary'
+End
+
+
+Style Lemma
+	CopyStyle             Theorem
+	LatexName             lem
+	LabelString           "Lemma \thelemma."
+	Preamble
+		\expandafter\providecommand\csname lyxlemname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxlemname\endcsname]{lem}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxlemname\endcsname{_(Lemma)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxlemname\endcsname{_(Lemma)}}
+	EndBabelPreamble
+	LabelCounter          lemma
+	DependsOn		Theorem
+	DocBookAttr           role='lemma'
+End
+
+
+Style Lemma*
+	CopyStyle             Theorem*
+	LatexName             lem*
+	LabelString           "Lemma."
+	Preamble
+		\expandafter\providecommand\csname lyxlem*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxlem*name\endcsname]{lem*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxlem*name\endcsname{_(Lemma)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxlem*name\endcsname{_(Lemma)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='lemma'
+End
+
+
+Style Proposition
+	CopyStyle             Theorem
+	LatexName             prop
+	LabelString           "Proposition \theproposition."
+	Preamble
+		\expandafter\providecommand\csname lyxpropname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxpropname\endcsname]{prop}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxpropname\endcsname{_(Proposition)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxpropname\endcsname{_(Proposition)}}
+	EndBabelPreamble
+	LabelCounter          proposition
+	DependsOn		Theorem
+	DocBookAttr           role='proposition'
+End
+
+
+Style Proposition*
+	CopyStyle             Theorem*
+	LatexName             prop*
+	LabelString           "Proposition."
+	Preamble
+		\expandafter\providecommand\csname lyxprop*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxprop*name\endcsname]{prop*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxprop*name\endcsname{_(Proposition)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxprop*name\endcsname{_(Proposition)}}
+	EndBabelPreamble
+	LabelCounter          proposition
+	DependsOn		Theorem
+	DocBookAttr           role='proposition'
+End
+
+
+Style Conjecture
+	CopyStyle             Theorem
+	LatexName             conjecture
+	LabelString           "Conjecture \theconjecture."
+	Preamble
+		\expandafter\providecommand\csname lyxconjecturename\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxconjecturename\endcsname]{conjecture}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxconjecturename\endcsname{_(Conjecture)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxconjecturename\endcsname{_(Conjecture)}}
+	EndBabelPreamble
+	LabelCounter          conjecture
+	DependsOn		Theorem
+	DocBookAttr           role='conjecture'
+End
+
+
+Style Conjecture*
+	CopyStyle             Theorem*
+	LatexName             conjecture*
+	LabelString           "Conjecture."
+	Preamble
+		\expandafter\providecommand\csname lyxconjecture*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxconjecture*name\endcsname]{conjecture*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxconjecture*name\endcsname{_(Conjecture)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxconjecture*name\endcsname{_(Conjecture)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='conjecture'
+End
+
+
+
+Style Fact
+	CopyStyle             Theorem
+	LatexName             fact
+	LabelString           "Fact \thefact."
+	Preamble
+		\expandafter\providecommand\csname lyxfactname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxfactname\endcsname]{fact}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxfactname\endcsname{_(Fact)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxfactname\endcsname{_(Fact)}}
+	EndBabelPreamble
+	LabelCounter          fact
+	DependsOn		Theorem
+	DocBookAttr           role='fact'
+End
+
+
+Style Fact*
+	CopyStyle             Theorem*
+	LatexName             fact*
+	LabelString           "Fact."
+	Preamble
+		\expandafter\providecommand\csname lyxfact*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxfact*name\endcsname]{fact*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxfact*name\endcsname{_(Fact)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxfact*name\endcsname{_(Fact)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='fact'
+End
+
+
+
+Style Definition
+	CopyStyle             Theorem
+	LatexName             defn
+	LabelString           "Definition \thedefinition."
+	Font
+	  Shape               Up
+	EndFont
+	LabelFont
+	  Shape               Up
+	  Series              Bold
+	EndFont
+	Preamble
+		\expandafter\providecommand\csname lyxdefnname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxdefnname\endcsname,style=definition]{defn}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxdefnname\endcsname{_(Definition)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxdefnname\endcsname{_(Definition)}}
+	EndBabelPreamble
+	LabelCounter          definition
+	DependsOn		Theorem
+	DocBookAttr           role='definition'
+End
+
+
+Style Definition*
+	CopyStyle             Theorem*
+	LatexName             defn*
+	LabelType             Static
+	LabelString           "Definition."
+	Font
+	  Shape               Up
+	EndFont
+	LabelFont
+	  Shape               Up
+	  Series              Bold
+	EndFont
+	Preamble
+		\expandafter\providecommand\csname lyxdefn*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxdefn*name\endcsname,style=definition]{defn*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxdefn*name\endcsname{_(Definition)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxdefn*name\endcsname{_(Definition)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='definition'
+End
+
+
+Style Example
+	CopyStyle             Definition
+	LatexName             example
+	LabelString           "Example \theexample."
+	Preamble
+		\expandafter\providecommand\csname lyxexamplename\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxexamplename\endcsname,style=definition]{example}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxexamplename\endcsname{_(Example)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxexamplename\endcsname{_(Example)}}
+	EndBabelPreamble
+	LabelCounter          example
+	DependsOn		Theorem
+	DocBookWrapperTag     informalexample
+	DocBookAttr           ""
+End
+
+
+Style Example*
+	CopyStyle             Definition*
+	LatexName             example*
+	LabelString           "Example."
+	Preamble
+		\expandafter\providecommand\csname lyxexample*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxexample*name\endcsname,style=definition]{example*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxexample*name\endcsname{_(Example)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxexample*name\endcsname{_(Example)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookWrapperTag     informalexample
+	DocBookAttr           ""
+End
+
+
+
+Style Problem
+	CopyStyle             Definition
+	LatexName             problem
+	LabelString           "Problem \theproblem."
+	Preamble
+		\expandafter\providecommand\csname lyxproblemname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxproblemname\endcsname,style=definition]{problem}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxproblemname\endcsname{_(Problem)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxproblemname\endcsname{_(Problem)}}
+	EndBabelPreamble
+	LabelCounter          problem
+	DependsOn		Theorem
+	DocBookAttr           role='problem'
+End
+
+
+Style Problem*
+	CopyStyle             Definition*
+	LatexName             problem*
+	LabelString           "Problem."
+	Preamble
+		\expandafter\providecommand\csname lyxproblem*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxproblem*name\endcsname,style=definition]{problem*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxproblem*name\endcsname{_(Problem)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxproblem*name\endcsname{_(Problem)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='problem'
+End
+
+
+Style Exercise
+	CopyStyle             Definition
+	LatexName             xca
+	LabelString           "Exercise \theexercise."
+	Preamble
+		\expandafter\providecommand\csname lyxxcaname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxxcaname\endcsname,style=definition]{xca}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxxcaname\endcsname{_(Exercise)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxxcaname\endcsname{_(Exercise)}}
+	EndBabelPreamble
+	LabelCounter          exercise
+	DependsOn		Theorem
+	DocBookAttr           role='exercise'
+End
+
+
+Style Exercise*
+	CopyStyle             Definition*
+	LatexName             xca*
+	LabelString           "Exercise."
+	Preamble
+		\expandafter\providecommand\csname lyxxca*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxxca*name\endcsname,style=definition]{xca*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxxca*name\endcsname{_(Exercise)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxxca*name\endcsname{_(Exercise)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='exercise'
+End
+
+
+Style Solution
+	CopyStyle             Definition
+	LatexName             sol
+	LabelString           "Solution \thesolution."
+	Preamble
+		\expandafter\providecommand\csname lyxsolname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxsolname\endcsname,style=definition]{sol}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxsolname\endcsname{_(Solution)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxsolname\endcsname{_(Solution)}}
+	EndBabelPreamble
+	LabelCounter          solution
+	DependsOn		Theorem
+	DocBookAttr           role='solution'
+End
+
+
+Style Solution*
+	CopyStyle             Definition*
+	LatexName             sol*
+	LabelString           "Solution."
+	Preamble
+		\expandafter\providecommand\csname lyxsol*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxsol*name\endcsname,style=definition]{sol*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxsol*name\endcsname{_(Solution)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxsol*name\endcsname{_(Solution)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='solution'
+End
+
+
+Style Remark
+	CopyStyle             Theorem
+	LatexName             rem
+	LabelString           "Remark \theremark."
+	Font
+	  Shape               Up
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Series              Medium
+	  Shape               Italic
+	EndFont
+	Preamble
+		\expandafter\providecommand\csname lyxremname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxremname\endcsname,style=remark]{rem}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxremname\endcsname{_(Remark)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxremname\endcsname{_(Remark)}}
+	EndBabelPreamble
+	LabelCounter          remark
+	DependsOn		Theorem
+	DocBookTag            note
+	DocBookItemTag        para
+End
+
+
+Style Remark*
+	CopyStyle             Theorem*
+	LatexName             rem*
+	LabelString           "Remark."
+	Font
+	  Shape               Up
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Series              Medium
+	  Shape               Italic
+	EndFont
+	Preamble
+		\expandafter\providecommand\csname lyxrem*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxrem*name\endcsname,style=remark]{rem*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxrem*name\endcsname{_(Remark)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxrem*name\endcsname{_(Remark)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookTag            note
+	DocBookItemTag        para
+End
+
+
+Style Claim
+	CopyStyle             Remark
+	LatexName             claim
+	LabelString           "Claim \theclaim."
+	Preamble
+		\expandafter\providecommand\csname lyxclaimname\endcsname{}
+		\declaretheorem[numberwithin=section,name=\protect\csname lyxclaimname\endcsname,style=remark]{claim}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxclaimname\endcsname{_(Claim)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxclaimname\endcsname{_(Claim)}}
+	EndBabelPreamble
+	LabelCounter          claim
+	DependsOn		Theorem
+	DocBookAttr           role='claim'
+        DocBookItemTag        ""
+End
+
+
+Style Claim*
+	CopyStyle             Remark*
+	LatexName             claim*
+	LabelString           "Claim."
+	Preamble
+		\expandafter\providecommand\csname lyxclaim*name\endcsname{}
+		\declaretheorem[numbered=no,name=\protect\csname lyxclaim*name\endcsname,style=remark]{claim*}
+	EndPreamble
+	LangPreamble
+		\expandafter\renewcommand\csname lyxclaim*name\endcsname{_(Claim)}
+	EndLangPreamble
+	BabelPreamble
+		\addto\captions$$lang{\expandafter\renewcommand\csname lyxclaim*name\endcsname{_(Claim)}}
+	EndBabelPreamble
+	DependsOn		Theorem
+	DocBookAttr           role='claim'
+	DocBookItemTag        ""
+End
+
+
+InsetLayout "Flex:List of Theorems"
+	LyXType				custom
+	LatexType			command
+	Decoration			classic
+	LatexName			listoftheorems
+	LabelString			"List of theorems"
+	Argument 1
+	  LabelString		"keys"
+	  Tooltip			"Insert wanted keys here"
+	  PassThru		1
+	  Mandatory		0
+	  AutoInsert	1
+	EndArgument
+	Font
+	  Color               latex
+	  Family              typewriter
+	EndFont
+	LabelFont
+	  Color               latex
+	  Size                Small
+	EndFont
+	MultiPar              true
+	CustomPars            false
+	ForcePlain            true
+	PassThru              true
+	ParbreakIsNewline     true
+	KeepEmpty             true
+	FreeSpacing           true
+	Preamble
+		\usepackage{thmtools}
+		\declaretheorem{lyxdummytheorem}
+	EndPreamble
+End
+
+Input theorems-case.inc
+Input theorems-proof.inc
+Input theorems-refprefix.inc
\ No newline at end of file
diff --git a/lib/layouts/theorems.inc b/lib/layouts/theorems.inc
index ee46bfb61a..b13bbf697f 100644
--- a/lib/layouts/theorems.inc
+++ b/lib/layouts/theorems.inc
@@ -3,6 +3,7 @@
 # modified and modularized by Emmanuel GUREGHIAN <gureghia@boston.bertin.fr>
 # Tinkered with Sep. '07 by Paul Rubin <rubin@msu.edu>
 # Modularized Jan 08 by Richard Kimberly Heck <rikiheck@lyx.org>
+# Edited sep '22 by Udi Fogiel <udifoglle@gmail.com>
 
 # The environments defined are :
 # - Theorem
@@ -26,10 +27,11 @@ OutlinerName thm "Definitions & Theorems"
 
 Style Theorem
 	Category              Reasoning
+	DependsOn             Udi
 	Margin                First_Dynamic
 	LatexType             Environment
 	LatexName             thm
-	NextNoIndent          1
+	NextNoIndent          0
 	ResetArgs             1
 	AddToToc              thm
 	IsTocCaption          1
@@ -59,6 +61,8 @@ Style Theorem
 	  Series              Bold
 	EndFont
 	Preamble
+		\newcommand\lyx@reg@newtheorem[2]{\newtheorem{#1}[thm]{#2}}
+		\newcommand\lyx@newtheorem{\@ifstar{\newtheorem*}{\lyx@reg@newtheorem}}
 		\theoremstyle{plain}
 		\newtheorem{thm}{\protect\theoremname}
 	EndPreamble
@@ -66,9 +70,57 @@ Style Theorem
 		\providecommand{\theoremname}{_(Theorem)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
+	  \addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
+	EndBabelPreamble
+	DocBookTag            para
+	DocBookAttr           role='theorem'
+End
+
+
+Style Theorem*
+	DependsOn             Theorem
+	Category              Reasoning
+	LatexType             Environment
+	Margin                First_Dynamic
+	LatexName             thm*
+	LabelType             Static
+	LabelString           "Theorem."
+	NextNoIndent          1
+	ResetArgs             1
+	AddToToc              thm
+	IsTocCaption          1
+	Argument 1
+		LabelString    "Additional Theorem Text"
+		Tooltip        "Additional text appended to the theorem header"
+		IsTocCaption      1
+	EndArgument
+	LabelSep              xx
+	ParIndent             MMM
+	ParSkip               0.4
+	ItemSep               0.2
+	TopSep                0.7
+	BottomSep             0.7
+	ParSep                0.3
+	Align                 Block
+	AlignPossible         Left
+	Font
+	  Shape               Italic
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Shape               Up
+	  Series              Bold
+	EndFont
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{thm*}{\protect\theoremname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\theoremname}{_(Theorem)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\theoremname}{_(Theorem)}}
 	EndBabelPreamble
-	Requires              amsthm
 	DocBookTag            para
 	DocBookAttr           role='theorem'
 End
@@ -80,16 +132,33 @@ Style Corollary
 	LatexName             cor
 	LabelString           "Corollary \thetheorem."
 	Preamble
-		\theoremstyle{plain}
-		\newtheorem{cor}[thm]{\protect\corollaryname}
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{cor}{\protect\corollaryname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\corollaryname}{_(Corollary)}
+	  \providecommand{\corollaryname}{_(Corollary)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
+	  \addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
+	EndBabelPreamble
+	DocBookAttr           role='corollary'
+End
+
+
+Style Corollary*
+	CopyStyle             Theorem*
+	LatexName             cor*
+	LabelString           "Corollary."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{cor*}{\protect\corollaryname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\corollaryname}{_(Corollary)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\corollaryname}{_(Corollary)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='corollary'
 End
 
@@ -100,16 +169,33 @@ Style Lemma
 	LatexName             lem
 	LabelString           "Lemma \thetheorem."
 	Preamble
-		\theoremstyle{plain}
-		\newtheorem{lem}[thm]{\protect\lemmaname}
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{lem}{\protect\lemmaname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\lemmaname}{_(Lemma)}
+	  \providecommand{\lemmaname}{_(Lemma)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
+	  \addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
+	EndBabelPreamble
+	DocBookAttr           role='lemma'
+End
+
+
+Style Lemma*
+	CopyStyle             Theorem*
+	LatexName             lem*
+	LabelString           "Lemma."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{lem*}{\protect\lemmaname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\lemmaname}{_(Lemma)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\lemmaname}{_(Lemma)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='lemma'
 End
 
@@ -120,16 +206,33 @@ Style Proposition
 	LatexName             prop
 	LabelString           "Proposition \thetheorem."
 	Preamble
-		\theoremstyle{plain}
-		\newtheorem{prop}[thm]{\protect\propositionname}
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{prop}{\protect\propositionname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\propositionname}{_(Proposition)}
+	  \providecommand{\propositionname}{_(Proposition)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
+	  \addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
+	EndBabelPreamble
+	DocBookAttr           role='proposition'
+End
+
+
+Style Proposition*
+	CopyStyle             Theorem*
+	LatexName             prop*
+	LabelString           "Proposition."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{prop*}{\protect\propositionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\propositionname}{_(Proposition)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\propositionname}{_(Proposition)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='proposition'
 End
 
@@ -140,16 +243,33 @@ Style Conjecture
 	LatexName             conjecture
 	LabelString           "Conjecture \thetheorem."
 	Preamble
-		\theoremstyle{plain}
-		\newtheorem{conjecture}[thm]{\protect\conjecturename}
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{conjecture}{\protect\conjecturename}
 	EndPreamble
 	LangPreamble
-		\providecommand{\conjecturename}{_(Conjecture)}
+	  \providecommand{\conjecturename}{_(Conjecture)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
+	  \addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
+	EndBabelPreamble
+	DocBookAttr           role='conjecture'
+End
+
+
+Style Conjecture*
+	CopyStyle             Theorem*
+	LatexName             conjecture*
+	LabelString           "Conjecture."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{conjecture*}{\protect\conjecturename}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\conjecturename}{_(Conjecture)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\conjecturename}{_(Conjecture)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='conjecture'
 End
 
@@ -160,16 +280,33 @@ Style Fact
 	LatexName             fact
 	LabelString           "Fact \thetheorem."
 	Preamble
-		\theoremstyle{plain}
-		\newtheorem{fact}[thm]{\protect\factname}
+	  \theoremstyle{plain}
+	  \lyx@newtheorem{fact}{\protect\factname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\factname}{_(Fact)}
+	  \providecommand{\factname}{_(Fact)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
+	  \addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
+	EndBabelPreamble
+	DocBookAttr           role='fact'
+End
+
+
+Style Fact*
+	CopyStyle             Theorem*
+	LatexName             fact*
+	LabelString           "Fact."
+	Preamble
+	  \theoremstyle{plain}
+	  \lyx@newtheorem*{fact*}{\protect\factname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\factname}{_(Fact)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\factname}{_(Fact)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='fact'
 End
 
@@ -187,16 +324,40 @@ Style Definition
 	  Series              Bold
 	EndFont
 	Preamble
-		\theoremstyle{definition}
-		\newtheorem{defn}[thm]{\protect\definitionname}
+	  \theoremstyle{definition}
+	  \lyx@newtheorem{defn}{\protect\definitionname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\definitionname}{_(Definition)}
+	  \providecommand{\definitionname}{_(Definition)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
+	  \addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
+	EndBabelPreamble
+	DocBookAttr           role='definition'
+End
+
+
+Style Definition*
+	CopyStyle             Theorem*
+	LatexName             defn*
+	LabelString           "Definition."
+	Font
+	  Shape               Up
+	EndFont
+	LabelFont
+	  Shape               Up
+	  Series              Bold
+	EndFont
+	Preamble
+	 \theoremstyle{definition}
+	 \lyx@newtheorem*{defn*}{\protect\definitionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\definitionname}{_(Definition)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\definitionname}{_(Definition)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='definition'
 End
 
@@ -206,17 +367,35 @@ Style Example
 	LatexName             example
 	LabelString           "Example \thetheorem."
 	Preamble
-		\theoremstyle{definition}
-		\newtheorem{example}[thm]{\protect\examplename}
+	  \theoremstyle{definition}
+	  \lyx@newtheorem{example}{\protect\examplename}
 	EndPreamble
 	LangPreamble
-		\providecommand{\examplename}{_(Example)}
+	  \providecommand{\examplename}{_(Example)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
+	  \addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
+	EndBabelPreamble
+	DocBookWrapperTag     informalexample
+	DocBookAttr           ""
+End
+
+
+Style Example*
+	CopyStyle             Definition*
+	LatexName             example*
+	LabelString           "Example."
+	Preamble
+	  \theoremstyle{definition}
+	  \lyx@newtheorem*{example*}{\protect\examplename}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\examplename}{_(Example)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\examplename}{_(Example)}}
 	EndBabelPreamble
 	DocBookWrapperTag     informalexample
-	DocBookTag            para
 	DocBookAttr           ""
 End
 
@@ -226,16 +405,33 @@ Style Problem
 	LatexName             problem
 	LabelString           "Problem \thetheorem."
 	Preamble
-		\theoremstyle{definition}
-		\newtheorem{problem}[thm]{\protect\problemname}
+	  \theoremstyle{definition}
+	  \lyx@newtheorem{problem}{\protect\problemname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\problemname}{_(Problem)}
+	  \providecommand{\problemname}{_(Problem)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
+	  \addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
+	EndBabelPreamble
+	DocBookAttr           role='problem'
+End
+
+
+Style Problem*
+	CopyStyle             Definition*
+	LatexName             problem*
+	LabelString           "Problem."
+	Preamble
+	  \theoremstyle{definition}
+	  \lyx@newtheorem*{problem*}{\protect\problemname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\problemname}{_(Problem)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\problemname}{_(Problem)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='problem'
 End
 
@@ -245,16 +441,33 @@ Style Exercise
 	LatexName             xca
 	LabelString           "Exercise \thetheorem."
 	Preamble
-		\theoremstyle{definition}
-		\newtheorem{xca}[thm]{\protect\exercisename}
+	  \theoremstyle{definition}
+	  \lyx@newtheorem{xca}{\protect\exercisename}
 	EndPreamble
 	LangPreamble
-		\providecommand{\exercisename}{_(Exercise)}
+	  \providecommand{\exercisename}{_(Exercise)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
+	  \addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
+	EndBabelPreamble
+	DocBookAttr           role='exercise'
+End
+
+
+Style Exercise*
+	CopyStyle             Definition*
+	LatexName             xca*
+	LabelString           "Exercise."
+	Preamble
+	  \theoremstyle{definition}
+	  \lyx@newtheorem*{xca*}{\protect\exercisename}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\exercisename}{_(Exercise)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\exercisename}{_(Exercise)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='exercise'
 End
 
@@ -264,8 +477,8 @@ Style Solution
 	LatexName             sol
 	LabelString           "Solution \thetheorem."
 	Preamble
-		\theoremstyle{definition}
-		\newtheorem{sol}[thm]{\protect\solutionname}
+	  \theoremstyle{definition}
+	  \lyx@newtheorem{sol}{\protect\solutionname}
 	EndPreamble
 	LangPreamble
 		\providecommand{\solutionname}{_(Solution)}
@@ -273,7 +486,24 @@ Style Solution
 	BabelPreamble
 		\addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
 	EndBabelPreamble
-	DocBookTag            para
+	DocBookAttr           role='solution'
+End
+
+
+Style Solution*
+	CopyStyle             Definition*
+	LatexName             sol*
+	LabelString           "Solution."
+	Preamble
+	  \theoremstyle{definition}
+	  \lyx@newtheorem*{sol*}{\protect\solutionname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\solutionname}{_(Solution)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\solutionname}{_(Solution)}}
+	EndBabelPreamble
 	DocBookAttr           role='solution'
 End
 
@@ -292,17 +522,44 @@ Style Remark
 	  Shape               Italic
 	EndFont
 	Preamble
-		\theoremstyle{remark}
-		\newtheorem{rem}[thm]{\protect\remarkname}
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{rem}{\protect\remarkname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\remarkname}{_(Remark)}
+	  \providecommand{\remarkname}{_(Remark)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
+	  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
 	EndBabelPreamble
+	DocBookItemTag        para
 	DocBookTag            note
+End
+
+
+Style Remark*
+	CopyStyle             Theorem*
+	LatexName             rem*
+	LabelString           "Remark."
+	Font
+	  Shape               Up
+	  Size                Normal
+	EndFont
+	LabelFont
+	  Series              Medium
+	  Shape               Italic
+	EndFont
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{rem*}{\protect\remarkname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\remarkname}{_(Remark)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
+	EndBabelPreamble
 	DocBookItemTag        para
+	DocBookTag            note
 End
 
 
@@ -311,19 +568,37 @@ Style Claim
 	LatexName             claim
 	LabelString           "Claim \thetheorem."
 	Preamble
-		\theoremstyle{remark}
-		\newtheorem{claim}[thm]{\protect\claimname}
+	  \theoremstyle{remark}
+	  \lyx@newtheorem{claim}{\protect\claimname}
 	EndPreamble
 	LangPreamble
-		\providecommand{\claimname}{_(Claim)}
+	  \providecommand{\claimname}{_(Claim)}
 	EndLangPreamble
 	BabelPreamble
-		\addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
+	  \addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
+	EndBabelPreamble
+	DocBookAttr           role='claim'
+	DocBookItemTag        "
+End
+
+
+Style Claim*
+	CopyStyle             Remark*
+	LatexName             claim*
+	LabelString           "Claim."
+	Preamble
+	  \theoremstyle{remark}
+	  \lyx@newtheorem*{claim*}{\protect\claimname}
+	EndPreamble
+	LangPreamble
+	  \providecommand{\claimname}{_(Claim)}
+	EndLangPreamble
+	BabelPreamble
+	  \addto\captions$$lang{\renewcommand{\claimname}{_(Claim)}}
 	EndBabelPreamble
-	DocBookTag            para
 	DocBookAttr           role='claim'
-	DocBookItemTag        ""
+	DocBookItemTag        "
 End
 
-Input theorems-case.inc
 Input theorems-refprefix.inc
+Input theorems-case.inc
\ No newline at end of file
